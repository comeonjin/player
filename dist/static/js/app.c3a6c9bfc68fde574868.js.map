{"version":3,"sources":["webpack:///src/App.vue","webpack:///./src/App.vue?b679","webpack:///./src/App.vue","webpack:///src/components/sevenDay2/Player.vue","webpack:///./src/components/sevenDay2/Player.vue?f71c","webpack:///./src/components/sevenDay2/Player.vue","webpack:///./src/router/index.js","webpack:///./src/store/store.js","webpack:///./src/main.js","webpack:///./src/components/common/lmc.js"],"names":["App","name","data","components","[object Object]","methods","selectortype_template_index_0_src_App","render","_h","this","$createElement","_c","_self","attrs","id","staticRenderFns","src_App","__webpack_require__","normalizeComponent","ssrContext","Player","computed","document","getElementsByTagName","innerHTML","window","location","href","split","initPlayer","getParams","initParams","map","item","params","lmc","init","appConfig","lmcServer","cacheJs","appId","appSign","expire","random","debug","errorPage","repeatPage","timeoutPage","volume","liveConfig","roomId","userConfig","userId","nickname","headerUrl","role","subGroupId","onlyGroupMsg","modules","notify","onInitCompleted","self","console","log","sevenDay2_Player","_m","staticClass","staticStyle","height","_v","components_sevenDay2_Player","Player_normalizeComponent","vue_esm","use","vue_router_esm","src_router","routes","path","component","vuex_esm","store","Store","state","userToken","currentCourseId","currentKnowledgeId","arrangeList","courseName","courseStartTime","getters","mutations","updateList","payload","setUserToken","setcurrentCourseId","setcurrentKnowledgeId","setCourseFinish","vue_resource_esm","config","productionTip","el","router","template","$","jQuery","LmcTools","_version","opera","postError","alert","time","Date","getTime","version","callFunction","callbackName","obj","param","_function","returnValue","mergeData","data1","data2","extend","loadScript","url","callback","length","Array","rand","Math","len","countName","successName","i","error","script","createElement","type","onload","readyState","onerror","src","indexOf","appendChild","debugLog","urlParam","encode","parseJson","str","json","parseJSON","e","eval","jsonStringify","JSON","stringify","isMobile","navigator","userAgent","match","isWeiXin","toLowerCase","setCahceVersion","getCahceVersion","allCharts","uuid16","uuid","floor","join","uuidInt","round","LmcIm","options","tools","loginInfo","listeners","baseConfig","userContainer","_this","_imBase","WebImBaseControllor","setTools","imConfig","clientConfig","sdkAppID","selSessHeadUrl","imUserConfig","selType","webim","SESSION_TYPE","GROUP","selToID","avChatRoomId","selSess","appIDAt3rd","accountType","identifier","identifierNick","userSig","userSign","isAccessFormalEnv","isLogOn","sdkLogin","sendCustomMsg","msg","sendTextMsg","toUserId","messageId","getEmojis","showMessage","fromClient","LmcController","_notify","_heartbeatIntervalId","_heartbeatInterval","_statusHeartbeatIntervalId","_userPointCountIntervalId","_imOptions","_status","liveUserCount","liveGroupUserCount","userStatus","liveStatus","serverTime","serverTimeDiff","liveStartTime","liveSuspendTime","liveEndTime","endTime","startTime","speaking","barrage","bgmusic","bgmusicUrl","orientation","currentMediaIndex","liveUserIds","_lmcBase","_cmd","_cmdData","_signedRoomMedia","_innerContainer","_userContainer","_pushUserToContainer","user","temp","change","pointValue","lastLoginTime","undefined","isOnline","extData","_statusHeartbeatInterval","_heartbeatImpl","_requestLmcData","action","success","_pollingTrigger","_statusHeartbeatImpl","im","_userPointCountPollingImpl","userPointCount","err","_timeCorrect","_userCountCorrect","isAsync","_appConfig","_liveConfig","_userConfig","baseData","isFromMobile","dataType","newData","ajax","async","jsonp","timeout","xhr","_isSameGroup","groupId","userSubGroupId","subgroupIds","userSubgroupIds","sameGroup","subgroupId","userSubgroupId","_getCmdParam","skipClientParam","target","_getSameGroupCmd","value","cmdDatas","target1","target2","target3","person","group","room","cmd","receiveSubgroupId","arriveTime","receiveUserId","Object","assign","_flushStatus","flushList","field","skip","_sendCustomMsgImpl","messageCofings","messageConfigs","messageConfig","max","maxValue","interval","intervalValue","users","roles","allow","flag","selfCustomMessage","selfCustomMessageList","content","oldCount","count","oldTime","lastTime","previousTime","customType","_notifyProxy","onUserDataChange","onPollingTrigger","onImTextSend","status","errInfo","useBarrage","textMsgInput","val","messageType","messageContent","userData","onImTextMsgArrive","onImCustomSend","setInterval","_statusHeartbeat","messageFlagType","point","pointConfigs","messageCount","messageTime","pointType","complexMatch","expressions","orther","expression","pattern","_prosessPoint","onImCustomArrive","msgData","points","contentJson","isNaN","onCommandArrive","resposeData","resposeParam","isSameGroup","push","mediaIndex","mediaConfigs","mediaConfig","lastOptionTime","realStartTime","realSuspendTime","realEndTime","checkMediaPlayer","statusValue","cmdData","checkBgMusicPlayer","onUserStatusChange","_showError","initTextMessageList","onMediaPlayerStatusChange","onLiveStatusChange","onTextMsgSend","onCustomMsgSend","onCommandSend","command","respose","sendCommand","onNetworkError","netNetStatusChange","initIm","onPrivateMsgArrive","_getSignedMediaWithGroup","tempMediaConfig","isMain","index","signedRoomMedias","signedRoomMedia","_getSignedMedia","_checkBgMusicPlayerImpl","audioUrl","_getCmdData","playAudio","loop","_checkAudioPlayerImpl","audioPlayerId","player","audioPlayerBox","$audioPlayer","innerAudioPlayerId","$innerAudioPlayer","find","$inner","attr","append","audio","$audio","get","addEventListener","_useAliyunPlay","opt","isLive","$mainPlayerInner","mobileVedioType","innerMainPlayerId","paltformType","ckplayerJsPath","serverConfig","resourceCdn","loadedHandler","css","width","$video","z-index","webkitExitFullscreen","pcUrls","defaultUrl","deff","first","v","flashvars","a","b","c","f","h","p","lv","loaded","isM3u8","defaultUrlSubs","lastIndexOf","video","empty","mobileUrl","CKobject","embed","bgcolor","allowFullScreen","allowScriptAccess","wmode","message","mainPlayerId","mianPlayerBox","page","repeatLogin","onRepeatlogin","onUserJoin","onUserOffline","onUserChange","onGetPoint","onWithdrawArrive","onImTextMsgSend","onCustomMsgRejected","onError","onOrientationChange","onAudioPlayerStatuChange","mianPlayerBoxBackground","auxPlayerBox","ignoreSuspend","ignoreEnd","voiceBtn","reverseHistoryMsg","emojis","emojiTextTemplate","maxWidth","maxHeight","imgs","_log","_options","supportFlush","ActiveXObject","Boolean","exception","mimeTypes","plugins","confirm","loadConfig","lmcBase","replace","extDatas","usesrCounts","userList","customMessageCount","chatItemRender","initCmdData","code","_config","cdn","urls","initMediaPlayer","initBgmusicPlayer","initExtDataList","initUserList","initCustomMessage","selfCustomMessageCount","finalId","loadHistoryTextMessage","historyMsgLoadComplete","imOptions","conf","imSign","imsdkAppID","imAccountType","imPlatformParam","slef","userPointValue","heartbeatInterval","_heartbeat","_userPointCountPolling","getUserPointCount","auxPlayerId","signedMedia","$mainPlayer","$auxPlayer","innerAuxPlayerId","cursor","$innerAuxPlayer","bg","bgImg","background","targetPlaybackMedia","signedPlaybackMedias","signedRoomPlaybackMedias","playbackPaltformType","show","playbakcPlatformType","playList","sort","bitrate","play","format","hide","pause","remove","_MT","stop","FLV_URL","HD_RTMP_URL","SD_RTMP_URL","M3U8_URL","huantuo_js","huantuo_auxPlayer","huantuo_mainPlayer","access_token","MT","SDK","main","camera","mainPlayer","_checkMediaPlayerImpl","setOption","option","commands","changeLiveStatus","statusFlag","withdraw","hasOwnProperty","commandParam","anchorRoomMedia","roomMedias","roomMedia","serverUsers","_getAnchorRoomMedia","getPlayerStatus","getUserList","getselfCustomMessageList","getCustomMessageCount","getSignedRoomMedia","getStatus","getBase","liveDesc","liveName","setUseBarrage","historyMsgLoadFinished","historyMsgLoadding","historyMsgEarliest","reverse","historyMsg","isHistory","parseInt","sync","ended","paused","WeixinJSBridge","invoke","duration","fastSeek","LMC","__webpack_exports__"],"mappings":"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","file":"static/js/app.c3a6c9bfc68fde574868.js","sourcesContent":["<template>\n    <div id=\"app\" >\n        <router-view  />\n    </div>\n    \n</template>\n\n<script>\n\nexport default {\n    name: 'App',\n    data(){\n        return {}\n    },\n    components: {},\n    created(){},\n    mounted(){},\n    destroyed(){},\n    methods: {}\n\n}\n</script>\n\n<style lang=\"less\">\nhtml,body{\n    margin: 0;\n    padding: 0;\n    width: 100%;\n    height: 100%;\n    background: #F2F2F2;\n}\n\n#app {\n    font-family: 'Avenir', Helvetica, Arial, sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    text-align: center;\n}\n\n</style>\n\n\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('router-view')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.2@vue-loader/lib/template-compiler?{\"id\":\"data-v-683ffe8a\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.2@vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true,\\\"importLoaders\\\":2}!../node_modules/_vue-loader@13.7.2@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-683ffe8a\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!px2rem-loader?{\\\"remUnit\\\":75}!less-loader?{\\\"sourceMap\\\":true}!../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/_vue-loader@13.7.2@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/_vue-loader@13.7.2@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-683ffe8a\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","<template>\n    <div id=\"window\">\n        <div id=\"view\">\n            <div id=\"player-box-container\" class=\"col-md-12 col-xs-12 player-box\">\n                <div id=\"mianPlayerBox\" style=\"height: 100%;\">\n                </div>\n                <div id=\"auxPlayerBox\">\n                </div>\n                <div id=\"audioPlayerBox\">\n                </div>\n            </div>\n            <div class=\"view-bottom\">\n\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\n    import LMC from '../common/lmc.js' \n    \n    export default {\n        data(){\n            return {\n                \n            }\n        },\n        computed:{},\n        created(){\n            \n            document.getElementsByTagName('title')[0].innerHTML = '视频播放'\n            if(window.location.href.split('?')[1]){\n                this.initPlayer(this.getParams())\n            }\n            // //参数说明(后三个): 课程id 课节id userToken\n            // let url = common.baseUrl+'play/'+this.$route.params.playType+'/'+this.currentCourseId+'/'+this.currentKnowledgeId+'/'+localStorage.getItem('userToken')\n            // alert('视频播放url: __'+url)\n            // axios.get(url).then((res)=> {\n            //     alert(JSON.stringify(res.data.appendData))\n            //     if(res.data.resultType === 1){\n            //         this.initPlayer(res.data.appendData)\n            //     }else{\n            //         alert(res.data.message)\n            //     }\n            // })\n            // this.initPlayer({\n            //     \"role\":\"student\",\n            //     \"headerUrl\":\"http%3A%2F%2Ftest27.aijianzi.com%2F%2Fupload%2Fhead%2F15739_big.jpg\",\n            //     \"replay\":true,\n            //     \"userId\":\"s15739\",\n            //     \"roomId\":\"4531\",\n            //     \"knowledgeId\":2303,\n            //     \"subGroupName\":\"\",\n            //     \"random\":\"9a6b5273e3044341a7d74482ce834f10\",\n            //     \"appSign\":\"8087AB8C230A628066DB62391D6943B3\",\n            //     \"appId\":\"aijianzi_test\",\n            //     \"subGroupId\":\"0\",\n            //     \"expire\":1534564516,\n            //     \"serverType\":\"LMC\",\n            //     \"nickname\":\"%E5%98%BF%E5%98%BF%E5%93%88%E5%93%88\",\n            //     \"courseId\":149})\n        },\n        mounted(){\n            \n        },\n        methods: {\n            getParams(){\n                let initParams = {}\n                window.location.href.split('?')[1].split('&').map((item) => {\n                    initParams[item.split('=')[0]] = item.split('=')[1]\n                })\n                return initParams\n            },\n            initPlayer(params){\n                LMC.init({\n                    appConfig: {\n                        // 应用配置\n                        lmcServer: \"https://lmc.91haoke.com/core\",\n                        cacheJs: true, // 是否缓存JavaScript文件,默认不缓存\n                        appId: params.appId, // 应用id\n                        appSign: params.appSign, // 应用授权签名,\n                        expire: params.expire, //鉴权到期时间\n                        random: params.random, //鉴权随机字符串\n                        debug: true, //是否输出调试信息\n                        errorPage: null, // 加载错误页面,\n                        repeatPage: null, // 重复登录错误页面,\n                        timeoutPage: null, // 鉴权超时错误页面\n                        volume: 80 // 默认音量\n                    },\n\n                    liveConfig: {\n                        // 直播配置\n                        roomId: params.roomId // 直播间id\n                    },\n\n                    userConfig: {\n                        // 用户配置\n                        userId: params.userId, // 用户身份标识\n                        nickname: params.nickname, // 用户身份标识\n                        headerUrl: params.headerUrl, // 用户头像路径\n                        role: params.role, // ['teacher','assistant','student']  用户权限，可以自行扩展\n                        subGroupId: params.subGroupId, //用户分组id,如果所属多个分则用逗号分隔,如果属于全部组则subGroupId为ALL\n                        onlyGroupMsg: true //设置用户是否只显示组内消息\n                    },\n\n                    modules: {\n                        //模块配置\n                        notify: {\n                            //初始化完成\n                            onInitCompleted: function(self) {\n                                console.log(self)\n                            }\n                        }\n                    }\n                })\n            }\n        }\n    }\n</script>\n\n<style lang=\"less\" scoped>\n    // #window{\n    //     position: absolute;\n    //     width: 100%;\n    //     height: 100%;\n    //     background: #fff;\n    // }\n</style>\n\n\n\n\n\n// WEBPACK FOOTER //\n// src/components/sevenDay2/Player.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"window\"}},[_c('div',{attrs:{\"id\":\"view\"}},[_c('div',{staticClass:\"col-md-12 col-xs-12 player-box\",attrs:{\"id\":\"player-box-container\"}},[_c('div',{staticStyle:{\"height\":\"100%\"},attrs:{\"id\":\"mianPlayerBox\"}}),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"auxPlayerBox\"}}),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"audioPlayerBox\"}})]),_vm._v(\" \"),_c('div',{staticClass:\"view-bottom\"})])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.2@vue-loader/lib/template-compiler?{\"id\":\"data-v-793a2607\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.2@vue-loader/lib/selector.js?type=template&index=0!./src/components/sevenDay2/Player.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true,\\\"importLoaders\\\":2}!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-793a2607\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!px2rem-loader?{\\\"remUnit\\\":75}!less-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=styles&index=0!./Player.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=script&index=0!./Player.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=script&index=0!./Player.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-793a2607\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=template&index=0!./Player.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-793a2607\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/sevenDay2/Player.vue\n// module id = null\n// module chunks = ","import Vue from 'vue'\nimport Router from 'vue-router'\n// import Seven from '@/components/sevenDay/index.vue'\n\n\nimport Player from '../components/sevenDay2/Player.vue'\n\nVue.use(Router)\n\nconst router = new Router({\n\n    routes: [\n       \n        {\n            path: '/',\n            name: 'Player',\n            component: Player\n        }\n        \n    ]\n})\n\nexport default router\n\n\n// WEBPACK FOOTER //\n// ./src/router/index.js","import Vue from 'vue'\nimport Vuex from 'vuex'\n\nVue.use(Vuex)\n\nlet Store = new Vuex.Store({\n    state: {\n\n        userToken: '',\n        //用于播放的当前课程id\n        currentCourseId: '',\n        //用于播放的当前课节id\n        currentKnowledgeId: '',\n        //课程安排列表数据\n        arrangeList: [],\n        //用于购买完成页面显示的课程名称和上课时间显示\n        courseName: '',\n        courseStartTime: ''\n    },\n    getters: {\n\n    },\n    mutations: {\n        updateList(state, payload){\n            state.arrangeList = payload\n        },\n        setUserToken(state, payload){\n            state.userToken = payload\n        },\n        setcurrentCourseId(state, payload){\n            state.currentCourseId = payload\n        },\n        setcurrentKnowledgeId(state, payload){\n            state.currentKnowledgeId = payload\n        },\n        //设置用于显示购课完成的finish页面的课程名称和首次上课时间\n        setCourseFinish(state, payload){\n            \n        }\n    }\n})\n\nexport default Store\n\n\n// WEBPACK FOOTER //\n// ./src/store/store.js","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport App from './App'\nimport router from './router'\nimport 'lib-flexible/flexible.js'\nimport store from './store/store.js'\n\nimport  VueResource  from 'vue-resource'\nVue.use(VueResource) \n\nVue.config.productionTip = false\n\n/* eslint-disable no-new */\nnew Vue({\n    el: '#app',\n    router,\n    store,\n    components: { App },\n    template: '<App/>'\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","/*/**\n * @copyright: [2016,gaosiedu.com]\n * @version: [v1.0.1]\n * @author: [lixun]\n * @description 直播媒体中心封装工具类\n * \n */\n\nfunction LmcTools() {\n\n\t// 控制台输出对象\n\tvar console = window.console || {};\n\t\n\tvar _version = '1_0_3';\n\t\n\t// 构造初始化\n\tfunction init() {\n\t\tconsole.log = console.log || (console.log = opera.postError);\n\t\tconsole.log = console.log || (window.alert);\n\t\tvar date = new Date();\n\t\tvar time = date.getTime() / 1000;\n\t\t_version = '' + (time - time % 86400);\n\t}\n\n\t// 执行初始化\n\tinit();\n\n\tthis.version = _version;\n\t\n\t/**\n\t * 调用函数\n\t * \n\t * @param callbackName\n\t *            函数名\n\t * @param obj\n\t *            函数对象\n\t * @param param\n\t *            函数调用时输入的实参\n\t */\n\tthis.callFunction = function(callbackName, obj, param) {\n\t\tif (!callbackName) {\n\t\t\treturn false;\n\t\t}\n\t\tobj = obj || window;\n\t\tvar _function = obj[callbackName];\n\t\tif (_function && typeof _function == 'function') {\n\t\t\tvar returnValue =  _function(param);\n\t\t\tif(typeof returnValue != 'undefined' && typeof returnValue == 'boolean'){\n\t\t\t\treturn returnValue;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * 合并数据\n\t * \n\t * @author lixun\n\t * @param\n\t */\n\tthis.mergeData = function(data1, data2) {\n\t\t$.extend(true, data1, data2);\n\t\treturn data1;\n\t}\n\n\t/**\n\t * 异步加载脚本\n\t */\n\tthis.loadScript = function(url, callback, cacheJs) {\n\t\tif (!url || !url.length || url == '') {\n\t\t\treturn false;\n\t\t}\n\t\tif (url instanceof Array) {\n\t\t\tvar rand = Math.random();\n\t\t\tvar len = url.length;\n\t\t\tvar countName = '__loadScript__' + rand + '__count';\n\t\t\tvar successName = '__loadScript__' + rand + '__success';\n\t\t\twindow[countName] = 0;\n\t\t\twindow[successName] = true;\n\t\t\tfor ( var i in url) {\n\t\t\t\tthis.loadScript(url[i], function(error) {\n\t\t\t\t\tif (!error) {\n\t\t\t\t\t\twindow[successName] = false;\n\t\t\t\t\t}\n\t\t\t\t\twindow[countName] = window[countName] + 1;\n\t\t\t\t\tif (window[countName] == len && callback) {\n\t\t\t\t\t\tcallback(window[successName]);\n\t\t\t\t\t\twindow[countName] = null;\n\t\t\t\t\t\twindow[successName] = null;\n\t\t\t\t\t}\n\t\t\t\t}, cacheJs);\n\t\t\t}\n\t\t} else if (typeof url == 'string') {\n\n\t\t\twindow['__loadScript__'] = window['__loadScript__'] || {};\n\t\t\tif (window['__loadScript__'][url] == 'loaded') {\n\t\t\t\tif (callback) {\n\t\t\t\t\tcallback(true);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\twindow['__loadScript__'][url] = 'loadding';\n\n\t\t\tvar script = document.createElement('script');\n\t\t\tscript.type = 'text/javascript';\n\t\t\tif (callback) {\n\t\t\t\tscript.onload = function() {\n\t\t\t\t\tif (script.readyState && script.readyState != 'loaded'\n\t\t\t\t\t\t\t&& script.readyState != 'complete') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tscript.onload = null;\n\t\t\t\t\twindow['__loadScript__'][url] = 'loaded';\n\t\t\t\t\tcallback(true);\n\t\t\t\t\treturn;\n\t\t\t\t};\n\n\t\t\t\tscript.onerror = function() {\n\t\t\t\t\tscript.onerror = null;\n\t\t\t\t\twindow['__loadScript__'][url] = 'error';\n\t\t\t\t\tcallback(false);\n\t\t\t\t\treturn;\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// script.onreadystatechange = function() {\n\t\t\t// if (script.readyState && script.readyState != 'loaded'&&\n\t\t\t// script.readyState != 'complete'){\n\t\t\t// callback(false);\n\t\t\t// }\n\t\t\t// script.onreadystatechange = null;\n\t\t\t// return;\n\t\t\t// };\n\t\t\tif (cacheJs == false) {\n\t\t\t\tscript.src = url + (url.indexOf('?') > -1 ? '&v=' : '?v=')\n\t\t\t\t\t\t+ new Date().getTime();\n\t\t\t} else {\n\t\t\t\tscript.src = url + (url.indexOf('?') > -1 ? '&v=' : '?v=') + this.version;\n\t\t\t}\n\t\t\tdocument.getElementsByTagName('body')[0].appendChild(script);\n\t\t}\n\t}\n\n\t/**\n\t * 输出调试日志\n\t */\n\tthis.debugLog = function(log) {\n\t\tconsole.debug(log);\n\t}\n\n\t/**\n\t * 输出带参数的url\n\t */\n\tthis.urlParam = function(url, param, encode) {\n\t\turl = url || '';\n\t\t// 判断是否有问号\n\t\tvar haveQmark = url.indexOf('?') > -1;\n\t\tif (!haveQmark) {\n\t\t\turl += '?';\n\t\t}\n\t\tparam = param || {};\n\t\turl += $.param(param);\n\t\treturn url;\n\t\t// url = url || '';\n\t\t// if (typeof encode == 'undefined') {\n\t\t// encode = false;\n\t\t// }\n\t\t// // 判断是否有问号\n\t\t// var haveQmark = url.indexOf('?') > -1;\n\t\t// if (!haveQmark) {\n\t\t// url += '?';\n\t\t// }\n\t\t//\t\t\n\t\t// var haveParam = url.indexOf('&') > -1;\n\t\t// param = param || {};\n\t\t//\n\t\t// var first = true;\n\t\t// for ( var key in param) {\n\t\t// if (key == '__proto__') {\n\t\t// continue;\n\t\t// }\n\t\t// if (first) {\n\t\t// if (!haveParam) {\n\t\t// url += '&';\n\t\t// }\n\t\t// first = false;\n\t\t// } else {\n\t\t// url += '&';\n\t\t// }\n\t\t// var value = param[key];\n\t\t// var t = typeof (param);\n\t\t//\t\t\t\n\t\t// if (value instanceof Array) {\n\t\t// for ( var index in value) {\n\t\t// var newValue = {\n\t\t// key : value[index]\n\t\t// };\n\t\t// url += this.urlParam('&', newValue, encode);\n\t\t// }\n\t\t// } else if (t == 'string' || value instanceof String\n\t\t// || t == 'number' || value instanceof Number\n\t\t// || t == 'boolean' || value instanceof Boolean) {\n\t\t// url += ('' + key);\n\t\t// if (encode) {\n\t\t// url += ('' + encodeURIComponent(value));\n\t\t// } else {\n\t\t// url += ('' + value);\n\t\t// }\n\t\t// } else if (t == 'object') {\n\t\t// url += this.urlParam('&', value, encode);\n\t\t// }\n\t\t// }\n\t\t// return url;\n\t}\n\n\t/**\n\t * 解析json数据\n\t */\n\tthis.parseJson = function(str) {\n\t\tif (!str) {\n\t\t\treturn null;\n\t\t}\n\t\tvar json = null;\n\t\ttry {\n\t\t\tjson = $.parseJSON(str);\n\t\t} catch (e) {\n\t\t\ttry {\n\t\t\t\tjson = $.parseJSON(\"(\" + str + \")\");\n\t\t\t} catch (e) {\n\t\t\t\ttry {\n\t\t\t\t\tjson = $.parseJSON('(' + str + ')');\n\t\t\t\t} catch (e) {\n\t\t\t\t\tjson = eval('(' + str + ')');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn json;\n\t}\n\n\t/**\n\t * 对象转字符串\n\t */\n\tthis.jsonStringify = function(obj) {\n\t\tif (!obj) {\n\t\t\treturn '';\n\t\t}\n\t\tif (JSON && JSON.stringify) {\n\t\t\treturn JSON.stringify(obj);\n\t\t}\n\t}\n\n\t\n\t/**\n\t * 判断是否为pc端\n\t * @returns {Boolean}\n\t */\n\tthis.isMobile = function() {\n\t\treturn navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i) ? true: false;\n\t}\n\t\n\t/**\n\t * 判断浏览器是否为微信浏览器\n\t * \n\t * @returns {Boolean}\n\t */\n\tthis.isWeiXin = function () {\n\t\tif(!this.isMobile()){\n\t\t\treturn false;\n\t\t}\n\t\tvar ua = navigator.userAgent.toLowerCase();\n\t\tif (ua.match(/MicroMessenger/i) == \"micromessenger\") {\n \t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}  \n\n\t/**\n\t * 设置统一的缓存版本号\n\t */\n\tthis.setCahceVersion = function(version){\n\t\tthis.version = version;\n\t};\n\t\n\t/**\n\t * 获取统一的缓存版本号\n\t */\n\tthis.getCahceVersion = function(){\n\t\treturn this.version;\n\t};\n\n\n\t//字符串序列\n\tthis.allCharts = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');\n\n    /**\n     * 对象转字符串\n     */\n    this.uuid16 = function() {\n    \tvar uuid = [16];\n        for (var i = 0; i < 16; i++) {\n            uuid[i] =this.allCharts[Math.floor(Math.random() * this.allCharts.length)];\n        }\n        return uuid.join(\"\");\n    }\n\n    /**\n\t * 生成整形的uuid\n     * @returns {number}\n     */\n    this.uuidInt = function() {\n        return Math.round(Math.random() * 4294967296);\n    }\n\n\n\n}\n\n/**\n * @copyright: [2016,gaosiedu.com]\n * @version: [v1.0.1]\n * @author: [lixun]\n * @description 直播媒体中心封装即时通信类\n * \n */\nfunction LmcIm(options) {\n\n\t/**\n\t * 工具函数\n\t */\n\tthis.tools = new LmcTools();\n\n\t/**\n\t * im 配置\n\t */\n\tthis.config = {\n\t\t'loginInfo' : {},\n\t\t'listeners' : {},\n\t\t'options' : {},\n\t\t'baseConfig' : {},\n\t\t'notify' : {},\n\t\t'userContainer' : {}\n\t};\n\n\t/**\n\t * 当前对象\n\t */\n\tvar _this = this;\n\n\t/**\n\t * im基础控制器\n\t */\n\tvar _imBase = null;\n\n\t/**\n\t * im 初始化\n\t */\n\tthis.init = function(param) {\n\n\t\t_imBase = new WebImBaseControllor();\n\t\t_imBase.setTools(_this.tools);\n\n\t\tvar imConfig = param.imConfig;\n\t\t_this.config.baseConfig = param.imConfig || {};\n\t\t_this.config.clientConfig = param.clientConfig || {};\n\t\t_this.config.notify = param.notify || {};\n\t\t_this.config.userContainer = param.userContainer || {};\n\n\t\t// 官方 demo appid,需要开发者自己修改（托管模式）\n\t\tvar sdkAppID = imConfig.sdkAppID;\n\n\t\t// 默认群组头像(选填)\n\t\tvar selSessHeadUrl = param.imUserConfig.headerUrl || param.imConfig.headerUrl;\n\t\t_this.config.baseConfig.selType = webim.SESSION_TYPE.GROUP;\n\t\t_this.config.baseConfig.selToID = imConfig.avChatRoomId;\n\t\t_this.config.baseConfig.selSess = null;\n\t\t_this.config.baseConfig.selSessHeadUrl = selSessHeadUrl;\n\n\t\t// 当前用户身份\n\t\tvar loginInfo = {\n\t\t\t'userId' : imConfig.userId,//系统中用户id,\n\t\t\t'appId' : imConfig.appId,//当前应用id\n\t\t\t'sdkAppID' : sdkAppID, // 用户所属应用id,必填\n\t\t\t'appIDAt3rd' : sdkAppID, // 用户所属应用id，必填\n\t\t\t'accountType' : imConfig.accountType, // 用户所属应用帐号类型，必填\n\t\t\t'identifier' : imConfig.identifier, //      当前用户ID,必须是否字符串类型，选填\n\t\t\t'identifierNick' : param.imUserConfig.nickname || imConfig.identifierNick || '匿名用户', // 当前用户昵称，选填\n\t\t\t'userSig' : imConfig.userSign, // 当前用户身份凭证，必须是字符串类型，选填\n\t\t\t'headerUrl' : param.imUserConfig.headerUrl,// 当前用户默认头像，选填,\n\t\t\t'subGroupId' : param.imUserConfig.subGroupId, // 分组id,\n\t\t\t'role' : param.imUserConfig.role,// 用户在直播间中的角色,\n\t\t\t'onlyGroupMsg' : param.imUserConfig.onlyGroupMsg\n\t\t// 设置用户是否只显示组内消息\n\t\t};\n\n\t\t_this.config.loginInfo = loginInfo;\n\n\t\tvar isAccessFormalEnv = true;// 是否访问正式环境\n\n\t\tvar isLogOn = param.debug;// 是否在浏览器控制台打印sdk日志\n\t\t// 其他对象，选填\n\t\tvar options = {\n\t\t\t'isAccessFormalEnv' : isAccessFormalEnv,// 是否访问正式环境，默认访问正式，选填\n\t\t\t'isLogOn' : isLogOn // 是否开启控制台打印日志,默认开启，选填\n\t\t};\n\n\t\t_this.config.options = options;\n\t\t// 登录im系统\n\t\t_imBase.sdkLogin(_this.config);\n\t}\n\n\t/**\n\t * 发送自定义消息\n\t */\n\tthis.sendCustomMsg = function(msg) {\n\t\t_imBase.sendCustomMsg(msg);\n\t}\n\t\n\t/**\n\t * 发送文本消息\n\t */\n\tthis.sendTextMsg = function(msg,toUserId,messageId) {\n\t\t_imBase.sendTextMsg(msg,toUserId,messageId);\n\t}\n\t\n\t/**\n\t * 获取emoji数据\n\t */\n\tthis.getEmojis = function() {\n\t\treturn _imBase.getEmojis();\n\t}\n\t\n\n\t/**\n\t * 主动调用显示消息\n\t */\n\tthis.showMessage = function(msg) {\n\t\tif (!msg) {\n\t\t\treturn false;\n\t\t}\n\t\tmsg.fromClient = true;\n\t\t_imBase.showMessage(msg);\n\t}\n\t\n//\t/**\n//\t * 推送用户数据\n//\t */\n//\tthis.pushUserData = function(userList){\n//\t\t_imBase.pushUserData(_this.config);\n//\t}\n}\n\n/**\n * @copyright: [2016,gaosiedu.com]\n * @version: [v1.0.1]\n * @author: [lixun]\n * @description 直播媒体中心控制器核心对象\n */\nfunction LmcController() {\n\t/**\n\t * 当前对象\n\t */\n\tvar _this = this;\n\t\n\t/**\n\t * 回调函数-通知函数容器\n\t */\n\tvar _notify = null;\n\n\t/**\n\t * 当前用户是否活动状态判断,如果用户重复登录之后则活动状态变回false\n\t */\n\tvar _isActive = true;\n\n\t/**\n\t * 心跳轮询定时器保存参数\n\t */\n\tvar _heartbeatIntervalId = null;\n\n\t/**\n\t * 心跳数据轮询间隔(5分钟轮询一次)\n\t */\n\tvar _heartbeatInterval = 5 * 60 * 1000;\n\n\t/**\n\t * 心跳轮询(用户状态)定时器保存参数\n\t */\n\tvar _statusHeartbeatIntervalId = null;\n\t\n\t/**\n\t * 心跳数据轮询(用户状态)间隔(5分钟轮询一次)\n\t */\n\tvar _statusHeartbeatInterval = 5 * 60 * 1000;\n\t\n\t/**\n\t * 用户积分统计数据轮询间隔(5分钟轮询一次)\n\t */\n\tvar _userPointCountIntervalId = null;\n\n\t/**\n\t * 用户积分统计数据轮询间隔(5分钟轮询一次)\n\t */\n\tvar _userPointCountInterval = 5 * 60 * 1000;\n\t\n\t/**\n\t * 未收到用户状态轮询判断用户离线的超时时长(心跳周期+20秒)\n\t */\n\tvar _userOffLineTimeOut = _statusHeartbeatInterval + 20 * 1000;\n\t\n\t/**\n\t * 及时通信参数\n\t */\n\tvar _imOptions = null;\n\n\t/**\n\t * 直播间状态\n\t */\n\tvar _status = {\n\t\t'liveUserCount' : 0, // 在线用户数量\n\t\t'liveGroupUserCount' : 0,// 同组在线用户数量\n\t\t'userStatus' : 'normal', // '\n\t\t'liveStatus' : 'wait', // live --> 直播中 , suspend -->暂停 end -->直播结束,\n\t\t'serverTime' : new Date().getTime(),// 服务器时间默认没有的情况下以客户端时间代替\n\t\t'serverTimeDiff' : 0,// 客户端与服务器端的时间差\n\t\t'liveStartTime' : 0, // 直播开始时间\n\t\t'liveSuspendTime' : 0,// 直播暂停时间\n\t\t'liveEndTime' : 0, // 直播结束时间\n\t\t'endTime' :0, //直播预计开始时间\n\t\t'startTime' : 0, //直播预计结束 时间\n\t\t'speaking' : 'on', // 禁言 off 表示禁言\n\t\t'barrage' : 'off', // 弹幕 off 表示使用弹幕,\n\t\t'bgmusic' : 'stop',//背景音乐开关,play表示播放,stop表示结束\n\t\t'bgmusicUrl' : '',//背景音乐url\n\t\t'orientation' :'', //屏幕方向\n\t\t'currentMediaIndex' : null, //当前的媒体对象\n\t\t'liveUserIds' : ''\n\t};\n\n\t/**\n\t * 媒体中心配置数据\n\t */\n\tvar _lmcBase = null;\n\n\t/**\n\t * 命令数据\n\t */\n\tvar _cmd = {};\n\t\n\t/**\n\t * 命令附加参数数据\n\t */\n\tvar _cmdData = {};\n\n\t/**\n\t * 播放器集合\n\t */\n\tvar _player = {};\n\n\t/**\n\t * 主要的主播媒体对象\n\t */\n\tvar _mainAnchorRoomMedia = null;\n\t\n\t/**\n\t * 鉴权后的媒体(用户正在使用的媒体)\n\t */\n\tvar _signedRoomMedia = null;\n\n\t/**\n\t * 内部容器(用于存放播放器参数)\n\t */\n\tvar _innerContainer = {};\n\n\t/**\n\t * 存放用户的容器\n\t */\n\tvar _userContainer = {};\n\n\t/**\n\t * 将用户压入容器\n\t */\n\tvar _pushUserToContainer = function(user){\n\t\tif(!user || !user.userId){\n\t\t\treturn false;\n\t\t}\n\t\tvar userId = user.userId;\n\t\tuser.self = user.userId == _this.options.userConfig.userId;\n\t\tif (user.self) {\n\t\t\tif(user.speaking == 'off'){\n\t\t\t\t_status.speaking = 'off';\n\t\t\t}\n\t\t}\n\t\tvar temp =  _userContainer[userId];\n\t\tif(!temp){\n\t\t\tif (_status.liveUserIds.indexOf(\";\"+userId+\";\") == -1) {\n\t\t\t\t_status.liveUserIds=_status.liveUserIds+\";\"+userId+\";\";\n\t\t\tif(!user.lastLoginTime || (user.lastLoginTime >= _status.serverTime - _userOffLineTimeOut)){\n\t\t\t\tif(!user.lastLoginTime){\n\t\t\t\t\tuser.lastLoginTime = _status.serverTime;\n\t\t\t\t}\n\t\t\t\tuser.isOnline = true;\n\t\t\t\t_status.liveUserCount++;\n\t\t\t\tif(user.subGroupId == _this.options.userConfig.subGroupId || _this.options.userConfig.subGroupId == 'ALL') {\n\t\t\t\t\t_status.liveGroupUserCount++;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t\tuser.isOnline = false;\n\t\t\t\t}\n\t\t\tuser.pointValue = user.pointValue || 0;\n\t\t\t_userContainer[userId] = user;\n\t\t\t_this.tools.callFunction('onUserJoin',_notify, user);\n\t\t\t}\n\t\t}else{\n\t\t\tvar change = false;\n\t\t\tif (temp.pointValue != user.pointValue) {\n\t\t\t\tchange = true;\n\t\t\t\ttemp.pointValue = user.pointValue || temp.pointValue;\n\t\t\t}\n\t\t\tif (temp.subGroupId != user.subGroupId) {\n\t\t\t\tchange = true;\n\t\t\t\ttemp.subGroupId = user.subGroupId || temp.subGroupId;\n\t\t\t}\n\t\t\tif ( temp.lastLoginTime != user.lastLoginTime && temp.lastLoginTime != undefined) {\n\t\t\t\tchange = true;\n\t\t\t\ttemp.lastLoginTime = user.lastLoginTime || temp.lastLoginTime;\n\t\t\t\tif(!temp.isOnline) {\n\t\t\t\t\ttemp.isOnline = true;\n\t\t\t\t\t\t_status.liveUserCount++;\n\t\t\t\t\t\tif(user.subGroupId == _this.options.userConfig.subGroupId || _this.options.userConfig.subGroupId == 'ALL') {\n\t\t\t\t\t\t\t_status.liveGroupUserCount++;\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if(temp.lastLoginTime == undefined || temp.isOnline == undefined) {\n\t\t\t\tchange = true;\n\t\t\t\ttemp.lastLoginTime = user.lastLoginTime || _status.serverTime;\n\t\t\t\ttemp.isOnline = true;\n\t\t\t}\n\t\t\tif (temp.role != user.role) {\n\t\t\t\tchange = true;\n\t\t\t\ttemp.role = user.role || temp.role;\n\t\t\t}\n\t\t\tif (temp.nickname != user.nickname) {\n\t\t\t\tchange = true;\n\t\t\t\ttemp.nickname = user.nickname || temp.nickname;\n\t\t\t}\n\t\t\tif (temp.headerUrl != user.headerUrl) {\n\t\t\t\tchange = true;\n\t\t\t\ttemp.headerUrl = user.headerUrl || temp.headerUrl;\n\t\t\t}\n\t\t\tif (temp.speaking != user.speaking) {\n\t\t\t\tchange = true;\n\t\t\t\ttemp.speaking = user.speaking || temp.speaking;\n\t\t\t}\n\t\t\tif (temp.extData != user.extData) {\n\t\t\t\tchange = true;\n\t\t\t\ttemp.extData = user.extData || temp.extData;\n\t\t\t}\n\t\t\tif(change){\n\t\t\t\t_this.tools.callFunction('onUserChange',_notify, temp);\n\t\t\t}\n\t\t}\n\t\t\n\t}\n\t\n\t/**\n\t * 心跳实现\n\t */\n\tvar _heartbeatImpl = function() {\n\t\t_requestLmcData({\n\t\t\t'action' : 'putHeartbeat',\n\t\t\t'data' : {\n\t\t\t\t'headerUrl' : _this.options.userConfig.headerUrl,\n\t\t\t\t'extData' :  _this.options.userConfig.extData\n\t\t\t},\n\t\t\t'success' : function(json) {\n\t\t\t\t_status.serverTime = json.serverTime || _status.serverTime;\n//\t\t\t\t_lmcBase.usesrCounts = json.data;\n//\t\t\t\t_flushStatus([ {\n//\t\t\t\t\t'name' : 'liveUserCount'\n//\t\t\t\t}, {\n//\t\t\t\t\t'name' : 'liveGroupUserCount'\n//\t\t\t\t} ]);\n\n\t\t\t\t// 轮询触发\n\t\t\t\t_pollingTrigger();\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * 心跳实现\n\t */\n\tvar _statusHeartbeatImpl = function() {\n\t\tvar data = _this.tools.mergeData({},_userContainer[_this.options.userConfig.userId]);\n\t\t// 计算当前在线的用户\n\t\t_this.im.sendCustomMsg({\n\t\t\t'type' : 'userStatusPolling',\n\t\t\t'data' : data\n\t\t});\n\t}\n\t\n\t/**\n\t * 用户积分获取轮询实现\n\t */\n\tvar _userPointCountPollingImpl = function() {\n\t\t_requestLmcData({\n\t\t\t'action' : 'getUserPointCount',\n\t\t\t'success' : function(json) {\n\t\t\t\tif(!json || json.error || !json.data){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t_lmcBase.userPointCount = json.data;\n\t\t\t},\n\t\t\t'error' : function(err) {\n\t\t\t}\n\t\t});\t\n\t}\n\n\t/**\n\t * 发送心跳数据\n\t */\n\tvar _heartbeat = function() {\n\t\tif (_heartbeatIntervalId) {\n\t\t\treturn false;\n\t\t}\n\t\t_heartbeatImpl();\n\t\t_heartbeatIntervalId = setInterval(function() {\n\t\t\tif (!_isActive) {\n\t\t\t\tif (_heartbeatIntervalId) {\n\t\t\t\t\tclearInterval(_heartbeatIntervalId);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t_heartbeatImpl();\n\t\t\t}\n\t\t}, _heartbeatInterval);\n\t}\n\n\t/**\n\t * 发送(状态)心跳数据-状态数据仅仅发送至客户端\n\t */\n\tvar _statusHeartbeat = function() {\n\t\tif (_statusHeartbeatIntervalId) {\n\t\t\treturn false;\n\t\t}\n\t\t// 状态轮询\n\t\t_statusHeartbeatImpl();\n\t\t_statusHeartbeatIntervalId = setInterval(function() {\n\t\t\tif (!_isActive) {\n\t\t\t\tif (_statusHeartbeatIntervalId) {\n\t\t\t\t\tclearInterval(_statusHeartbeatIntervalId);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t_statusHeartbeatImpl();\n\t\t\t}\n\t\t}, _statusHeartbeatInterval);\n\t}\n\t\n\t\n\t/**\n\t * 用户积分统计轮询\n\t */\n\tvar _userPointCountPolling = function() {\n\t\tif (_userPointCountIntervalId) {\n\t\t\treturn false;\n\t\t}\n\t\t// 状态轮询\n\t\t_userPointCountPollingImpl();\n\t\t_userPointCountIntervalId = setInterval(function() {\n\t\t\tif (!_isActive) {\n\t\t\t\tif (_userPointCountIntervalId) {\n\t\t\t\t\tclearInterval(_userPointCountIntervalId);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t_userPointCountPollingImpl();\n\t\t\t}\n\t\t}, _userPointCountInterval);\n\t}\n\n\t/**\n\t * 轮询触发\n\t */\n\tvar _pollingTrigger = function() {\n\t\t_this.tools.callFunction('onPollingTrigger', _notify, _status);\n\t}\n\n\t/**\n\t * 时间修正\n\t */\n\tvar _timeCorrect = function() {\n\t\t_status.serverTime += 1000;\n\t}\n\t\n\t/**\n\t * 用户在线人数修正\n\t */\n\tvar _userCountCorrect = function (){\n\t\tif(!_userContainer){\n\t\t\treturn false;\n\t\t}\n\t\tfor ( var userId in _userContainer) {\n\t\t\tif (!userId) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tvar user = _userContainer[userId];\n\t\t\tif(!user){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tif(!user.lastLoginTime || (user.lastLoginTime <  _status.serverTime - _userOffLineTimeOut)){\n\t\t\t\tif(user.isOnline == true) {\n\t\t\t\t\tuser.isOnline = false;\n\t\t\t\t\t_status.liveUserCount--;\n\t\t\t\t\tif(user.subGroupId == _this.options.userConfig.subGroupId || _this.options.userConfig.subGroupId == 'ALL') {\n\t\t\t\t\t\t_status.liveGroupUserCount--;\n\t\t\t\t\t}\n\t\t\t\t\t_this.tools.callFunction('onUserChange',_notify, user);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * 加载直播间配置\n\t * \n\t * @param 加载参数\n\t */\n\tvar _requestLmcData = function(param, isAsync) {\n\t\tvar _appConfig = _this.options.appConfig;\n\t\tvar _liveConfig = _this.options.liveConfig;\n\t\tvar _userConfig = _this.options.userConfig;\n\n\t\t// 基础数据\n\t\tvar baseData = {\n\t\t\t'appId' : _appConfig.appId,\n\t\t\t'appSign' : _appConfig.appSign,\n\t\t\t'expire' :  _appConfig.expire,\n\t\t\t'random' : _appConfig.random,\n\t\t\t'roomId' : _liveConfig.roomId,\n\t\t\t'userId' : _userConfig.userId,\n\t\t\t'role' : _userConfig.role,\n\t\t\t'subGroupId' : _userConfig.subGroupId,\n\t\t\t'nickname' : _userConfig.nickname,\n\t\t\t'isFromMobile' : _this.tools.isMobile(),\n\t\t\t'dataType' : 'jsonp'\n\t\t};\n\n\t\tvar data = param.data || {};\n\n\t\tvar newData = {};\n\t\t_this.tools.mergeData(newData, data);\n\t\t_this.tools.mergeData(newData, baseData);\n\n\t\tif (typeof isAsync == 'undefined') {\n\t\t\tisAsync = true;\n\t\t}\n\t\t$.ajax({\n\t\t\tasync : !!isAsync,\n\t\t\turl : _appConfig.lmcServer + '/' + param.action,\n\t\t\ttype : \"POST\",\n\t\t\tdataType : 'jsonp',\n\t\t\tjsonp : 'jsoncallback',\n\t\t\tdata : newData,\n\t\t\ttimeout : 5000,\n\t\t\tsuccess : function(json) {// 客户端jquery预先定义好的callback函数,成功获取跨域服务器上的json数据后,会动态执行这个callback函数\n\t\t\t\tvar json = json;\n\t\t\t\t_this.debugLog('lmcData : ');\n\t\t\t\t_this.debugLog(json);\n\t\t\t\t_this.tools.callFunction('success', param, json);\n\t\t\t},\n\t\t\terror : function(xhr) {\n\t\t\t\t_this.tools.callFunction('onError', {\n\t\t\t\t\t'type' : 'getLmcConfigError'\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\n\t/**\n\t * 判断分组id是否为同组\n\t */\n\tvar _isSameGroup = function(groupId) {\n\t\tif (!groupId) {\n\t\t\treturn false;\n\t\t}\n\t\tif(groupId == 'ALL'){\n\t\t\treturn true;\n\t\t}\n\t\tvar userSubGroupId = _this.options.userConfig.subGroupId;\n\t\tvar subgroupIds = groupId.split(',');\n\t\tvar userSubgroupIds = userSubGroupId.split(',');\n\n\t\tvar sameGroup = false;\n\t\tfor ( var subgroupId in subgroupIds) {\n\t\t\tfor ( var userSubgroupId in userSubgroupIds) {\n\t\t\t\tif (subgroupIds[subgroupId] == userSubgroupIds[userSubgroupId]) {\n\t\t\t\t\tsameGroup = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (sameGroup) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn sameGroup;\n\t}\n\n\t/**\n\t * 获取命令参数数据\n\t */\n\tvar _getCmdParam = function(type, skipClientParam) {\n\t\tif (!skipClientParam) {\n\t\t\tvar temp = _cmd[type];\n\t\t\tif (temp) {\n\t\t\t\treturn temp;\n\t\t\t}\n\t\t}\n\t\tvar target = _getSameGroupCmd(type);\n\t\tif(!target){\n\t\t\treturn null;\n\t\t}\n\t\tif (target == null) {\n\t\t\treturn {};\n\t\t}\n\t\t_cmd[type] = target.value;\n\t\treturn target.value;\n\t}\n\n\t\n\t/**\n\t * 获取命令参数附加数据\n\t */\n\tvar _getCmdData = function(type, skipClientParam) {\n\t\tif (!skipClientParam) {\n\t\t\tvar temp = _cmdData[type];\n\t\t\tif (temp) {\n\t\t\t\treturn temp;\n\t\t\t}\n\t\t}\n\t\tvar target = _getSameGroupCmd(type);\n\t\tif(!target){\n\t\t\treturn {};\n\t\t}\n\t\t_cmdData[type] = target.cmdData;\n\t\treturn target.cmdData;\n\t}\n\t\n\t\n\t/**\n\t * 获取同组命令\n\t */\n\tvar _getSameGroupCmd = function(type){\n\t\tif (!_lmcBase.cmdDatas || !_lmcBase.cmdDatas.length) {\n\t\t\treturn null;\n\t\t}\n\t\tvar cmdDatas = _lmcBase.cmdDatas;\n\t\tvar target = null;\n\t\tvar target1 = null;\n\t\tvar target2 = null;\n\t\tvar target3 = null;\n\t\tvar temp = null;\n\t\tif(type == 'speaking' && _this.options.userConfig.role == 'student') {\n\t\t\tvar person = 1,\n\t\t\t\tgroup = 1,\n\t\t\t\troom = 1;\n\n\t\t\tfor ( var i in cmdDatas) {\n\t\t\tvar cmd = cmdDatas[i];\n\t\t\tif(!cmd){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (type == cmd.type) {\n\t\t\t\ttemp = cmd;\n\t\t\t\tif (!cmd.receiveSubgroupId || cmd.receiveSubgroupId != 'ALL') {\n\t\t\t\t\tvar sameGroup = _isSameGroup(cmd.receiveSubgroupId);\n\t\t\t\t\tvar self = cmd.receiveUserId && cmd.receiveUserId == _this.options.userConfig.userId;\n\t\t\t\t\tif (!sameGroup && !self) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else if(sameGroup) {/*\n\t\t\t\t\t\t\tif(cmd.receiveSubgroupId == 'ALL') {\n\t\t\t\t\t\t\t\tif (null == target1 || temp.arriveTime > target1.arriveTime) {\n\t\t\t\t\t\t\t\t\ttarget1 = cmd;\n\t\t\t\t\t\t\t\t\tif(cmd.value == 'on') {\n\t\t\t\t\t\t\t\t\t\t\troom = 1;\n\t\t\t\t\t\t\t\t\t\t} else if(cmd.value == 'off') {\n\t\t\t\t\t\t\t\t\t\t\troom = 0;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {*/\n\t\t\t\t\t\t\t\tif (null == target2 || temp.arriveTime > target2.arriveTime) {\n\t\t\t\t\t\t\t\t\ttarget2 = cmd;\n\t\t\t\t\t\t\t\t\tif(cmd.value == 'on') {\n\t\t\t\t\t\t\t\t\t\tgroup = 1;\n\t\t\t\t\t\t\t\t\t} else if(cmd.value == 'off') {\n\t\t\t\t\t\t\t\t\t\tgroup = 0;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/*}*/\n\t\t\t\t\t} else if(self) {\n\t\t\t\t\t\tif (null == target3 || temp.arriveTime > target3.arriveTime) {\n\t\t\t\t\t\t\ttarget3 = cmd;\n\t\t\t\t\t\t\tif(cmd.value == 'on') {\n\t\t\t\t\t\t\t\tperson = 1;\n\t\t\t\t\t\t\t} else if(cmd.value == 'off') {\n\t\t\t\t\t\t\t\tperson = 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else if(cmd.receiveSubgroupId == 'ALL') {\n\t\t\t\t\tif (null == target1 || temp.arriveTime > target1.arriveTime) {\n\t\t\t\t\t\ttarget1 = cmd;\n\t\t\t\t\t\tconsole.log(cmd);\n\t\t\t\t\t\tif(cmd.value == 'on') {\n\t\t\t\t\t\t\troom = 1;\n\t\t\t\t\t\t} else if(cmd.value == 'off') {\n\t\t\t\t\t\t\troom = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconsole.log(room);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!target) {\n\t\t\t\t\ttarget = Object.assign({}, temp);\n\t\t\t\t} /*else {\n\t\t\t\t\t// 取出命令到达时间最晚的命令\n\t\t\t\t\tif (temp.arriveTime > target.arriveTime) {\n\t\t\t\t\t\ttarget = temp;\n\t\t\t\t\t}\n\t\t\t\t}*/\n\t\t\t\tif( person && group && room) {\n\t\t\t\t\ttarget.value = 'on';\n\t\t\t\t} else {\n\t\t\t\t\ttarget.value = 'off';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn target;\n\t\t} else {\n\t\tfor ( var i in cmdDatas) {\n\t\t\tvar cmd = cmdDatas[i];\n\t\t\tif(!cmd){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (type == cmd.type) {\n\t\t\t\tif (!cmd.receiveSubgroupId || cmd.receiveSubgroupId != 'ALL') {\n\t\t\t\t\tvar sameGroup = _isSameGroup(cmd.receiveSubgroupId);\n\t\t\t\t\tvar self = cmd.receiveUserId && cmd.receiveUserId == _this.options.userConfig.userId;\n\t\t\t\t\tif (!sameGroup && !self) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttemp = cmd;\n\t\t\t\tif (!target) {\n\t\t\t\t\ttarget = cmd;\n\t\t\t\t} else {\n\t\t\t\t\t// 取出命令到达时间最晚的命令\n\t\t\t\t\tif (temp.arriveTime > target.arriveTime) {\n\t\t\t\t\t\ttarget = temp;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn target;\n\t\t}\n\t}\n\t\n\t/**\n\t * 刷新状态\n\t * \n\t * @param flush\n\t *            如果我true表示强制取出服务端的命令,如果为false则表示可以取出客户端缓存的命令\n\t */\n\tvar _flushStatus = function(flushList) {\n\n\t\tif (!flushList) {\n\t\t\tflushList = [ {\n\t\t\t\t'name' : 'liveStatus'\n\t\t\t}, {\n\t\t\t\t'name' : 'speaking'\n\t\t\t}, {\n\t\t\t\t'name' : 'barrage'\n\t\t\t}, {\n\t\t\t\t'name' : 'bgmusic'\n\t\t\t}, {\n\t\t\t\t'name' : 'liveUserCount'\n\t\t\t}, {\n\t\t\t\t'name' : 'liveGroupUserCount'\n\t\t\t} ];\n\t\t}\n\n\t\tif (flushList) {\n\t\t\tfor ( var i in flushList) {\n\t\t\t\tvar field = flushList[i];\n\t\t\t\tvar name = field.name;\n\t\t\t\tvar skipClientParam = field.skip;\n\t\t\t\tif (name == 'liveStatus') {\n\t\t\t\t\t_status.liveStatus = _getCmdParam('liveStatus',skipClientParam) || _status.liveStatus;\n\t\t\t\t} else if (name == 'speaking') {\n\t\t\t\t\t_status.speaking = _getCmdParam('speaking', skipClientParam) || _status.speaking;\n\t\t\t\t} else if (name == 'barrage') {\n\t\t\t\t\t_status.barrage = _getCmdParam('barrage', skipClientParam) || _status.barrage;\n\t\t\t\t} else if (name == 'bgmusic') {\n\t\t\t\t\t_status.bgmusic = _getCmdParam('bgmusic', skipClientParam) || _status.bgmusic;\n\t\t\t\t} else if (name == 'liveUserCount') {\n//\t\t\t\t\tif (_lmcBase.usesrCounts) {\n//\t\t\t\t\t\t_status.liveUserCount = 0;\n//\t\t\t\t\t\tfor ( var i in _lmcBase.usesrCounts) {\n//\t\t\t\t\t\t\tvar usesrCount = _lmcBase.usesrCounts[i];\n//\t\t\t\t\t\t\tvar subgroupId = usesrCount.subgroupId;\n//\t\t\t\t\t\t\tvar count = usesrCount.count;\n//\t\t\t\t\t\t\tif (count > 0) {\n//\t\t\t\t\t\t\t\t_status.liveUserCount += count;\n//\t\t\t\t\t\t\t}\n//\t\t\t\t\t\t}\n//\t\t\t\t\t\tif (_status.liveUserCount == 0) {\n//\t\t\t\t\t\t\t_status.liveUserCount = 1;\n//\t\t\t\t\t\t}\n//\t\t\t\t\t}\n\t\t\t\t} else if (name == 'liveGroupUserCount') {\n//\t\t\t\t\tif (_lmcBase.usesrCounts) {\n//\t\t\t\t\t\t_status.liveGroupUserCount = 0;\n//\t\t\t\t\t\tfor ( var i in _lmcBase.usesrCounts) {\n//\t\t\t\t\t\t\tvar usesrCount = _lmcBase.usesrCounts[i];\n//\t\t\t\t\t\t\tvar subgroupId = usesrCount.subgroupId;\n//\t\t\t\t\t\t\tvar count = usesrCount.count;\n//\t\t\t\t\t\t\tif (_isSameGroup(subgroupId) && count > 0) {\n//\t\t\t\t\t\t\t\t_status.liveGroupUserCount += count;\n//\t\t\t\t\t\t\t}\n//\t\t\t\t\t\t}\n//\t\t\t\t\t\tif (_status.liveGroupUserCount == 0) {\n//\t\t\t\t\t\t\t_status.liveGroupUserCount = 1;\n//\t\t\t\t\t\t}\n//\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t/**\n\t * 发送自定义消息实现\n\t */\n\tvar _sendCustomMsgImpl = function(msg){\n\t\tvar data = msg.data || {};\n\t\tvar type = msg.type;\n\t\tvar messageCofings = _lmcBase.messageConfigs;\n\t\tif(!messageCofings){\n\t\t\treturn false;\n\t\t}\n\t\tvar messageConfig = messageCofings[type];\n\t\tif(!messageConfig){\n\t\t\t_this.tools.callFunction('onCustomMsgRejected',_notify, {'error' : 'undefined','msg' : msg});\n\t\t\treturn false;\n\t\t}\n\t\t// 发送自定义消息最的次数限制\n\t\tvar max = messageConfig.maxValue || 0;\n\t\t// 发送自定义消息发送时间间隔\n\t\tvar interval = messageConfig.intervalValue || 0;\n\t\t// 指定可发送对应消息的用户\n\t\tvar users = messageConfig.users;\n\t\t// 制定可发送对应消息的角色\n\t\tvar roles = messageConfig.roles;\n\t\t\n\t\tvar userId = _this.options.userConfig.userId;\n\t\tvar role = _this.options.userConfig.role;\n\t\t// 校验权限\n\t\tvar allow = true;\n\t\tif((users && users.length) || (roles && roles.length)){\n\t\t\tallow = false;\n\t\t\tif(users && users.length){\n\t\t\t\tfor(var i in users){\n\t\t\t\t\tif(userId == users[i]){\n\t\t\t\t\t\tallow = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!allow && (roles && roles.length)){\n\t\t\t\tfor(var i in roles){\n\t\t\t\t\tif(role == roles[i]){\n\t\t\t\t\t\tallow = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(!allow){\n\t\t\t_this.tools.callFunction('onCustomMsgRejected',_notify, {'error' : 'not_allow','msg' : msg});\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tvar messageFlagType = data.flag || type;\n\t\tvar messageId = userId + '_' + type + '_' + messageFlagType;\n\t\t\n\t\tvar time = (new Date()).getTime();\n\t\t\n\t\tvar selfCustomMessage = _lmcBase.selfCustomMessageList[messageId];\n\t\tif(!selfCustomMessage){\n\t\t\tselfCustomMessage = {};\n\t\t\tselfCustomMessage.time = time;\n\t\t\tselfCustomMessage.previousTime = time;\n\t\t\tselfCustomMessage.content = data.content;\n\t\t\tselfCustomMessage.customType = type;\n\t\t\tselfCustomMessage.count = 1;\n\t\t\t_lmcBase.selfCustomMessageList[messageId] = selfCustomMessage;\n\t\t}else {\n\t\t\tselfCustomMessage.content = data.content;\n\t\t\tvar oldCount = selfCustomMessage.count || 0;\n\t\t\tvar oldTime = selfCustomMessage.time;\n\t\t\tif('initCompleted' != type){ //初始化消息特殊处理\n\t\t\t\tif(max && oldCount >= max){\n\t\t\t\t\t_this.tools.callFunction('onCustomMsgRejected', _notify, {\n\t\t\t\t\t\t'error' : 'too_much',\n\t\t\t\t\t\t'max' : max,\n\t\t\t\t\t\t'msg' : msg\n\t\t\t\t\t});\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif(interval && oldTime + (interval * 1000) >= time){\n\t\t\t\t\t_this.tools.callFunction('onCustomMsgRejected', _notify, {\n\t\t\t\t\t\t'error' : 'too_fast',\n\t\t\t\t\t\t'lastTime' : oldTime,\n\t\t\t\t\t\t'interval' : interval,\n\t\t\t\t\t\t'time' : time,\n\t\t\t\t\t\t'msg' : msg\n\t\t\t\t\t});\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tselfCustomMessage.previousTime = oldTime;\n\t\t\tselfCustomMessage.count = oldCount + 1 ;\n\t\t\tselfCustomMessage.time = time;\n\t\t}\n\t\t_this.im.sendCustomMsg(msg);\t\t\n\t}\n\t\n\t/**\n\t * 计算积分\n\t */\n\tvar _prosessPoint = function(type,flag,data){\n\t\t//计算自定义消息对应积分\n\t\tvar points = _lmcBase.pointConfigs || {};\n\t\tvar point = points[type + '_' + flag];\n\t\tif (point) {\n\t\t\tvar userId = _this.options.userConfig.userId;\n\t\t\tvar messageFlagType = data.flag || type;\n\t\t\tvar messageId = userId + '_' + type + '_' + messageFlagType;\n\t\t\t\n\t\t\tvar selfCustomMessage = _lmcBase.selfCustomMessageList[messageId];\n\t\t\t\n\t\t\t// 是否允许获得积分\n\t\t\tvar allow = true;\n\t\t\tif(selfCustomMessage){\n\t\t\t\tvar time = selfCustomMessage.time || (new Date()).getTime();\n\t\t\t\t// 消息发送计数\n\t\t\t\tvar messageCount = selfCustomMessage.count;\n\t\t\t\t// 消息发送时间\n\t\t\t\tvar messageTime = selfCustomMessage.previousTime;\n\t\t\t\t// 获取积分的次数限制\n\t\t\t\tvar max = point.maxValue || 0;\n\t\t\t\t// 获取积分时间间隔\n\t\t\t\tvar interval = point.intervalValue || 0;\n\t\t\t\tvar count = selfCustomMessage.count;\n\t\t\t\tif(max && messageCount > max){\n\t\t\t\t\tallow = false;\n\t\t\t\t}\n\t\t\t\tif(interval && count > 1 && (messageTime + interval * 1000) > time){\n\t\t\t\t\tallow = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!allow){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\tvar pointValue = 0;\n\t\t\tvar pointType = point.type;\n\t\t\tvar complexMatch = false;\n\t\t\tif (!pointType || pointType == 'simple') {\n\t\t\t\tpointValue = point.pointValue;\n\t\t\t} else if ('complex' == pointType) {\n\t\t\t\tvar target = data.content;\n\t\t\t\tvar expressions = point.expressions;\n\t\t\t\tif (expressions && expressions.length) {\n\t\t\t\t\tvar orther = null;\n\t\t\t\t\tfor ( var i in expressions) {\n\t\t\t\t\t\tvar expression = expressions[i];\n\t\t\t\t\t\tvar pattern = expression.pattern;\n\t\t\t\t\t\tif (!pattern) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (pattern == '_$ORTHER$_') {\n\t\t\t\t\t\t\torther = expression;\n\t\t\t\t\t\t} else if (pattern == target) {\n\t\t\t\t\t\t\tpointValue = expression.pointValue;\n\t\t\t\t\t\t\tcomplexMatch = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (!pointValue && orther) {\n\t\t\t\t\t\tpointValue = orther.pointValue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(pointValue){\n\t\t\t\tpointValue = pointValue - 0;\n\t\t\t}\n\t\t\tif(pointValue){\n\t\t\t\tvar self = _userContainer[_this.options.userConfig.userId];\n\t\t\t\tif(self){\n\t\t\t\t\t//发送积分变化通知\n\t\t\t\t\t_this.tools.callFunction('onGetPoint',_notify, {\n\t\t\t\t\t\t'pointValue' : pointValue,\n\t\t\t\t\t\t'type' : type,\n\t\t\t\t\t\t'pointType' : pointType,\n\t\t\t\t\t\t'complexMatch' : complexMatch\n\t\t\t\t\t});\n\t\t\t\t\t// 通知客户端用户发生变化\n\t\t\t\t\tvar oldValue = self.pointValue;\n\t\t\t\t\tpointValue += (oldValue || 0);\n\t\t\t\t\tself.pointValue = pointValue;\n\t\t\t\t\t_this.tools.callFunction('onUserChange',_notify, self);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\n\t}\n\n\t/**\n\t * 通知代理\n\t */\n\tvar _notifyProxy = {\n\t\t'onInitCompleted' : function(msg){\n\t\t\tmsg = msg || {};\n\t\t\t_sendCustomMsgImpl({\n\t\t\t\t'type' : 'initCompleted'\n\t\t\t});\n\t\t\t_this.tools.callFunction('onInitCompleted',_notify, msg);\n\t\t\treturn true;\n\t\t},\n\t\t'onUserDataChange' : function(msg) {\n\t\t\tmsg = msg || {};\n\t\t\tif('changeProfile' == msg.type){\n\t\t\t\t_pushUserToContainer(msg.data);\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\t'onPollingTrigger' : function(msg) {\n\t\t\tmsg = msg || {};\n\t\t\t_this.tools.callFunction('onPollingTrigger',_notify, msg);\n\t\t\treturn true;\n\t\t},\n\t\t'onImTextSend' : function(msg) {// 当im发送文本信息完成时回调\n\t\t\tmsg = msg || {};\n\t\t\t\n\t\t\tif(msg.status == 'error'){\n\t\t\t\t_this.tools.callFunction('onError',_notify, {\n\t\t\t\t\t'type' : 'sendTextMsgError',\n\t\t\t\t\t'errInfo' : msg.errInfo\n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (_status.barrage == 'on' && _this.options.modules.im.useBarrage) {\n\t\t\t\t$('#' + _this.options.modules.im.textMsgInput).val('');\n\t\t\t\t// 判断服务端允许使用弹幕且,用户允许发送弹幕,并且发送自定义消息\n\t\t\t\t_this.im.sendCustomMsg({\n\t\t\t\t\t'type' : 'barrage',\n\t\t\t\t\t'data' : {\n\t\t\t\t\t\t'content' : msg.content,\n\t\t\t\t\t\t'messageId': msg.messageId\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\t// 将消息同步发送到lmc服务器\n\t\t\t_requestLmcData({\n\t\t\t\t'action' : 'saveMessage',\n\t\t\t\t'data' : {\n\t\t\t\t\t'messageType' : 'text',\n\t\t\t\t\t'messageContent' : msg.content,\n\t\t\t\t\t'messageId' : msg.messageId,\n\t\t\t\t\t'userData' : _this.tools.jsonStringify({\n\t\t\t\t\t\t'nickname' : _this.options.userConfig.nickname,\n\t\t\t\t\t\t'headerUrl' : _this.options.userConfig.headerUrl,\n\t\t\t\t\t\t'role' : _this.options.userConfig.role\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}, true);\n\t\t\t_this.tools.callFunction('onImTextSend',_notify, msg);\n\t\t\treturn true;\n\t\t},\n        'onImTextMsgArrive' : function(msg) {// 当im文本消息到达时回调\n\t\t\tif(!msg){\n\t\t\t\treturn false;\n\t\t\t}\n            _this.tools.callFunction('onImTextMsgArrive',_notify, msg);\n            return true;\n        },\n\t\t'onImCustomSend' : function(msg) {// 当im发送自定义信息完成时回调\n\t\t\tmsg = msg || {};\n\t\t\tvar data = msg.data || {};\n\t\t\tvar type = data.type;\n\t\t\t// 将消息同步发送到lmc服务器\n\t\t\tif ('userLogin' == type) {\n\t\t\t\t// 开启状态轮询\n\t\t\t\t_statusHeartbeat();\n\t\t\t} else if('userStatusPolling' != type){\n\t\t\t\tvar messageFlagType = msg.data.data.flag || type;\n\t\t\t\t_requestLmcData({\n\t\t\t\t\t'action' : 'saveMessage',\n\t\t\t\t\t'data' : {\n\t\t\t\t\t\t'messageType' : 'custom',\n\t\t\t\t\t\t'messageContent' : msg.data.data.content,\n\t\t\t\t\t\t'flag' : messageFlagType,\n\t\t\t\t\t\t'customType' : type\n\t\t\t\t\t}\n\t\t\t\t}, false);\n\t\t\t\t// 计算自定义消息获得的积分\n\t\t\t\t_prosessPoint(type, messageFlagType, data.data);\n\t\t\t}\n\t\t\t_this.tools.callFunction('onImCustomSend',_notify, msg);\n\t\t\treturn true;\n\t\t},\n\t\t'onImCustomArrive' : function(msg) {// 当自定义消息到达时回调\n\t\t\tmsg = msg || {};\n\t\t\tvar type = msg.type;\n\t\t\tvar data = msg.data || {};\n\t\t\tif ('userStatusPolling' == type) {\n\t\t\t\t// 如果是用户状态轮询消息则不用通知服务端端,而是在客户端自行处理\n\t\t\t\tvar userData = data.userData || {};\n\t\t\t\tuserData.lastLoginTime = _status.serverTime || (new Date()).getTime();\n\t\t\t\tif(data.msgData){\n\t\t\t\t\tuserData.pointValue = data.msgData.pointValue;\n\t\t\t\t}\n\t\t\t\t_pushUserToContainer(userData);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\tif ('barrage' == type) {\n\t\t\t\t_this.tools.callFunction('onImCustomArrive',_notify, msg);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\tvar points = _lmcBase.pointConfigs;\n\t\t\tif(points){\n\t\t\t\tvar point = points[type + '_' + (data.msgData.flag || type)];\n\t\t\t\tif (point && point.type == 'multiple') {\n\t\t\t\t\tvar data = msg.data || {};\n\t\t\t\t\tvar msgData = data.msgData || {};\n\t\t\t\t\tvar userId = _this.options.userConfig.userId;\n\t\t\t\t\tvar content = msgData.content;\n\t\t\t\t\tvar pointValue = null;\n\t\t\t\t\tif(content){\n\t\t\t\t\t\tcontentJson = _this.tools.parseJson(content);\n\t\t\t\t\t\tif(contentJson){\n\t\t\t\t\t\t\tpointValue = contentJson[userId];\n\t\t\t\t\t\t\tif(pointValue && !isNaN(pointValue)){\n\t\t\t\t\t\t\t\tpointValue = pointValue - 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(pointValue){\n\t\t\t\t\t\tvar self = _userContainer[_this.options.userConfig.userId];\n\t\t\t\t\t\tif(self){\n\t\t\t\t\t\t\t//发送积分变化通知\n\t\t\t\t\t\t\t_this.tools.callFunction('onGetPoint',_notify, {\n\t\t\t\t\t\t\t\t'pointValue' : pointValue,\n\t\t\t\t\t\t\t\t'type' : type,\n\t\t\t\t\t\t\t\t'pointType' : point.type\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t// 通知客户端用户发生变化\n\t\t\t\t\t\t\tvar oldValue = self.pointValue;\n\t\t\t\t\t\t\tpointValue += (oldValue || 0);\n\t\t\t\t\t\t\tself.pointValue = pointValue;\n\t\t\t\t\t\t\t_this.tools.callFunction('onUserChange',_notify, self);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t_this.tools.callFunction('onImCustomArrive',_notify, msg);\n\t\t},\n\t\t'onCommandArrive' : function(msg) {// 当自命令消息到达时回调\n\t\t\tmsg = msg || {};\n\t\t\t// 命令类型,部分命令需要先进行内部处理再分发到客户端\n\t\t\tvar type = msg.type;\n\t\t\t// 响应数据\n\t\t\tvar resposeData = msg.data.resposeData || {};\n\t\t\t// 响应参数发送命令时的参数\n\t\t\tvar resposeParam = msg.data.resposeParam || {};\n\t\t\tvar cmd = resposeData.data;\n\t\t\tif(cmd.receiveSubgroupId && !_this.isSameGroup(cmd.receiveSubgroupId)){\n\t\t\t\t// 如果是单独发送给某一个组的命令则匹配之后再发送,不匹配则直接忽略\n\t\t\t\treturn ;\n\t\t\t}\n\t\t\tif(cmd.receiveUserId && cmd.receiveUserId != _this.options.userConfig.userId){\n\t\t\t\t// 如果是单独发送给某一个用户的命令则匹配之后再发送,不匹配则直接忽略\n\t\t\t\treturn ;\n\t\t\t}\n\t\t\t_lmcBase.cmdDatas.push(cmd);\n\t\t\tswitch (type) {\n\t\t\tcase 'changeLiveStatus': // 收到了一个变更直播状态的命令\n\t\t\t\t// 主播媒体对象\n\t\t\t\tvar mediaIndex = resposeParam.mediaIndex;\n\t\t\t\t// 命令操作的媒体对象在用户所拥有的目标媒体对象\n\t\t\t\tvar target = null;\n\t\t\t\tfor ( var i in _lmcBase.mediaConfigs) {\n\t\t\t\t\tvar mediaConfig = _lmcBase.mediaConfigs[i];\n\t\t\t\t\tif (mediaConfig.mediaIndex == mediaIndex) {\n\t\t\t\t\t\ttarget = mediaConfig;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!target) {\n\t\t\t\t\t// 如果未找到则忽略\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar liveStatus = resposeParam.status;\n\t\t\t\ttarget.liveStatus = liveStatus;\n\t\t\t\ttarget.lastOptionTime = resposeData.serverTime;\n\t\t\t\tif ('start' == liveStatus) {\n\t\t\t\t\ttarget.realStartTime = resposeData.serverTime;\n\t\t\t\t\t_status.realStartTime = resposeData.serverTime;\n\t\t\t\t} else if ('suspend' == liveStatus) {\n\t\t\t\t\ttarget.realSuspendTime = resposeData.serverTime;\n\t\t\t\t\t_status.realSuspendTime = resposeData.serverTime;\n\t\t\t\t} else if ('end' == liveStatus) {\n\t\t\t\t\ttarget.realEndTime = resposeData.serverTime;\n\t\t\t\t\t_status.realEndTime = resposeData.serverTime;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t_status.currentMediaIndex = mediaIndex;\n\t\t\t\t_status.serverTime = resposeData.serverTime || _status.serverTime;\n\t\t\t\t_status.serverTimeDiff = new Date().getTime() - resposeData.serverTime;\n\t\t\t\t_status.liveStatus = target.liveStatus;\n\t\t\t\t_status.lastOptionTime = target.lastOptionTime || 0;\n\t\t\t\t_status.realStartTime = target.realStartTime || 0;\n\t\t\t\t_status.liveStartTime = target.realStartTime || 0;\n\t\t\t\t_status.realEndTime = target.realEndTime || 0;\n\t\t\t\t_status.currentMediaIndex = mediaIndex;\n\t\t\t\t_status.liveStatus = liveStatus;\n\t\t\t\t_status.endTime = target.endTime || 0;\n\t\t\t\t_status.startTime = target.startTime || 0;\n\t\t\t\t\n\t\t\t\t_this.tools.callFunction('onLiveStatusChange', _notify, {\n\t\t\t\t\t'status' : liveStatus\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t// 重新检查播放器状态\n\t\t\t\t_this.checkMediaPlayer();\n\t\t\t\t_pollingTrigger();\n\t\t\t\tbreak;\n\t\t\tcase 'speaking': // 收到禁言变更命令\n\t\t\t\t_flushStatus([ {\n\t\t\t\t\t'name' : 'speaking',\n\t\t\t\t\t'skip' : true\n\t\t\t\t} ]);\n\t\t\t\tvar statusValue = _getCmdParam('speaking');\n\t\t\t\t_status.speaking = statusValue;\n\n\t\t\t\t_userContainer[_this.options.userConfig.userId].speaking = _status.speaking;//不确定\n\n\t\t\t\t_pollingTrigger();\n\t\t\t\tbreak;\n\t\t\tcase 'barrage': // 收到弹幕变更命令\n\t\t\t\t_flushStatus([ {\n\t\t\t\t\t'name' : 'barrage',\n\t\t\t\t\t'skip' : true\n\t\t\t\t} ]);\n\t\t\t\tvar statusValue = _getCmdParam('barrage');\n\t\t\t\t_status.barrage = statusValue;\n\t\t\t\t_pollingTrigger();\n\t\t\t\tbreak;\n\t\t\tcase 'bgmusic': // 收到背景音乐变更消息\n\t\t\t\t_flushStatus([ {\n\t\t\t\t\t'name' : 'bgmusic',\n\t\t\t\t\t'skip' : true\n\t\t\t\t} ]);\n\t\t\t\t\n\t\t\t\tvar statusValue = _getCmdParam('bgmusic');\n\t\t\t\t_status.bgmusicUrl = resposeParam.cmdData || '';\n\t\t\t\t_status.bgmusic = statusValue;\n\t\t\t\t// 重新背景音乐播放器状态\n\t\t\t\t_this.checkBgMusicPlayer();\n\t\t\t\t_pollingTrigger();\n\t\t\t\tbreak;\n\t\t\tcase 'withdraw': // 收到撤回消息命令\n                var messageId = resposeParam.messageId;\n                if(messageId){\n                    _this.tools.callFunction('onWithdrawArrive', _notify, {\n                        'messageId' : messageId\n                    });\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t_this.tools.callFunction('onCommandArrive', _notify, msg);\n\t\t\treturn true;\n\t\t},\n\t\t'onUserStatusChange' : function(msg) {// 当用户状态变化时回调\n\t\t\tif (msg.type == 'userLoginStatusNotify' && msg.status == 'repeat') {\n\t\t\t\t_showError('repeat', '在其他终端登录,被迫下线');\n\t\t\t\treturn false;\n\t\t\t}else if (msg.type == 'userLoginStatusNotify' && msg.status == 'login') {\n//\t\t\t\t_status.liveUserCount++;\n//\t\t\t\t_status.liveGroupUserCount++;\n\t\t\t\t_pollingTrigger();\n\t\t\t} else if (msg.type == 'userLoginStatusNotify' && msg.status == 'loginSuccess') {\n\t\t\t\t// loginSuccess 只会在用户登录时自己向自己发起回调\n\t\t\t\t_this.initTextMessageList();\n\t\t\t}\n\t\t\t_this.tools.callFunction('onUserStatusChange', _notify, msg);\n\t\t\treturn true;\n\t\t},\n\t\t'onMediaPlayerStatusChange' : function(msg) {// 当媒体播放器状态变化时回调\n\t\t\tmsg = msg || {};\n\t\t\t_this.tools.callFunction('onMediaPlayerStatusChange', _notify, msg);\n\t\t\treturn true;\n\t\t},\n\t\t'onLiveStatusChange' : function(msg) {// 当直播状态变化时回调\n\t\t\tmsg = msg || {};\n\t\t\t_this.tools.callFunction('onLiveStatusChange', _notify, msg);\n\t\t\treturn true;\n\t\t},\n\t\t'onTextMsgSend' : function(msg) {// 当发送普通消息时回调\n\t\t\tmsg = msg || {};\n\t\t\t_this.tools.callFunction('onTextMsgSend', _notify, msg);\n\t\t\treturn true;\n\t\t},\n\t\t'onCustomMsgSend' : function(msg) {// 当发送自定义消息时回调\n\t\t\tmsg = msg || {};\n\t\t\t_this.tools.callFunction('onCustomMsgSend', _notify, msg);\n\t\t\treturn true;\n\t\t},\n\t\t'onCommandSend' : function(msg) {// 当发送自定义消息时回调\n\t\t\tmsg = msg || {};\n\t\t\tif (msg.status == 'success') {\n\t\t\t\tif (msg.data.data.command == 'changeLiveStatus') {\n\t\t\t\t\tvar respose = msg.data.data.respose;\n\t\t\t\t\t_status.liveStatus = respose.liveStatus || respose.data.value;\n\t\t\t\t\t_status.serverTime = respose.serverTime;\n\t\t\t\t\t_pollingTrigger();\n\t\t\t\t\t\n\t\t\t\t\t// 状态改变时发送一条停止背景音乐的命令\n\t\t\t\t\t_this.sendCommand({\n\t\t\t\t\t\t'type' : 'bgmusic',\n\t\t\t\t\t\tparam : {\n\t\t\t\t\t\t\t'status' : 'stop'\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\t_this.tools.callFunction('onCommandSend', _notify, msg);\n\t\t\treturn true;\n\t\t},\n\t\t'onNetworkError' : function(msg) {// 网络错误\n\t\t\t_this.tools.callFunction('onNetworkError', _notify, msg);\n\t\t\treturn true;\n\t\t},\n        'netNetStatusChange' : function(msg) {// 网络状态变更\n\t\t\tif(msg.status != 'online'){\n                if(msg.status == 'reconnect'){\n                    //网络状态恢复重新登录\n                    _this.initIm(_imOptions);\n                }else if(msg.status == 'offline'){\n                    _this.tools.callFunction('onNetworkError', _notify, msg);\n                }\n            }\n            return true;\n        },\n        'onPrivateMsgArrive' : function(msg) {// 收到私聊消息\n\t\t\t_this.tools.callFunction('onPrivateMsgArrive', _notify, msg);\n            return true;\n        }\n\t}\n\n\t/**\n\t * 获取主播控制媒体对象\n\t */\n\tvar _getAnchorRoomMedia = function() {\n\t\tvar roomMedias = _lmcBase.mediaConfigs;\n\t\tif (roomMedias && roomMedias.length > 0) {\n\t\t\tfor ( var i in roomMedias) {\n\t\t\t\tvar roomMedia = roomMedias[i];\n\t\t\t\tvar serverUsers = roomMedia['users'];\n\t\t\t\tif(serverUsers){\n\t\t\t\t\tfor(var i in serverUsers){\n\t\t\t\t\t\tif (serverUsers[i] == _this.options.userConfig.userId) {\n\t\t\t\t\t\t\treturn roomMedia;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t * 获取鉴权的媒体参数\n\t */\n\tvar _getSignedMedia = function(index) {\n\t\tvar signedRoomMedias = _lmcBase.room.signedRoomMedias;\n\t\tif (signedRoomMedias && signedRoomMedias.length > 0) {\n\t\t\tfor ( var i in signedRoomMedias) {\n\t\t\t\tvar signedRoomMedia = signedRoomMedias[i];\n\t\t\t\tif (signedRoomMedia.index == index) {\n\t\t\t\t\treturn signedRoomMedia;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t\n\t/**\n\t * 获取鉴权的媒体参数-根据当前所在的组 \n\t */  \n\tvar _getSignedMediaWithGroup = function() {\n\t\t// 如果当前媒体索引未找到则更新当前媒体索引\n\t\tvar userId = _this.options.userConfig.userId;\n\t\tif (!_status.currentMediaIndex) {\n\t\t\tvar lastOptionTime = 0; // 媒体的最后操作时间,将作为时间优先依据\n\t\t\tvar liveStatus = ''; // 媒体的最后操作状态,将作为状态优先依据\n\t\t\tvar tempMediaConfig = null;// 临时的媒体配置对象\n\t\t\tfor ( var i in _lmcBase.mediaConfigs) {\n\t\t\t\tvar mediaConfig = _lmcBase.mediaConfigs[i];\n\t\t\t\tif(!mediaConfig.liveStatus){\n\t\t\t\t\tmediaConfig.liveStatus = 'wait';\n\t\t\t\t}\n\t\t\t\tif(!mediaConfig.lastOptionTime){\n\t\t\t\t\tmediaConfig.lastOptionTime = 0;\n\t\t\t\t}\n\t\t\t\tif (!tempMediaConfig) {\n\t\t\t\t\ttempMediaConfig = mediaConfig;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (mediaConfig.users) {\n\t\t\t\t\t// 如果当前用户是媒体控制者,则优先将控制者对应的媒体作为当前媒体\n\t\t\t\t\t// _this.options.userConfig.userId\n\t\t\t\t\tfor ( var i in mediaConfig.users) {\n\t\t\t\t\t\t// 如果当前用户是媒体控制者,则优先将控制者对应的媒体作为当前媒体\n\t\t\t\t\t\tif (mediaConfig.users[i] == userId) {\n\t\t\t\t\t\t\ttempMediaConfig = mediaConfig;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// liveStatus;\n\t\t\t\t// lastOptionTime;\n\t\t\t\t// realStartTime;\n\t\t\t\t// realEndTime;\n\t\t\t\tif (!mediaConfig.lastOptionTime && !tempMediaConfig.lastOptionTime) {\n\t\t\t\t\t// 如果媒体操作时间都为空(都未开始)\n\t\t\t\t\tif(mediaConfig.isMain){\n\t\t\t\t\t\ttempMediaConfig = mediaConfig;\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}else if(tempMediaConfig.liveStatus == 'end' && mediaConfig.liveStatus != 'end'){\n\t\t\t\t\t// 找到未结束的直播\n\t\t\t\t\ttempMediaConfig = mediaConfig;\n\t\t\t\t}else if (mediaConfig.lastOptionTime > tempMediaConfig.lastOptionTime) {\n\t\t\t\t\t// 如果均有操作,按照时间优先原则,优先找到最后操作的媒体\n\t\t\t\t\ttempMediaConfig = mediaConfig;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (tempMediaConfig) {\n\t\t\t\t_status.currentMediaIndex = tempMediaConfig.mediaIndex;\n\t\t\t\t_status.endTime = tempMediaConfig.endTime;\n\t\t\t\t_status.startTime = tempMediaConfig.startTime;\n\t\t\t\t_status.liveStatus = tempMediaConfig.liveStatus;\n\t\t\t\t_status.lastOptionTime = tempMediaConfig.lastOptionTime || 0;\n\t\t\t\t_status.realStartTime = tempMediaConfig.realStartTime || 0;\n\t\t\t\t_status.liveStartTime = tempMediaConfig.realStartTime || 0;\n\t\t\t\t_status.realEndTime = tempMediaConfig.realEndTime || 0;\n\t\t\t}\n\t\t}\n\t\treturn _getSignedMedia(_status.currentMediaIndex);\n\t}\n\n\t/**\n\t * 检查和渲染播放器的内部实现\n\t */\n\tvar _checkMediaPlayerImpl = function() {\n\t\t// 'mianPlayerBox' : 'mianPlayerBox',//主播放器容器id(主播放器用于播放推流视频和推流白板)\n\t\t// 'auxPlayerBox' : 'auxPlayerBox',//辅助放器容器id(辅助播放器用于播放广告,摄像头等)\n\t\t// 'audioPlayerBox' : 'audioPlayerBox'//主播放器容器id(音频播放器用于播放一般声音,暖场音频等)\n\t\t// 'ignoreSuspend' : false,//是否忽略暂停命令,一般用于教师端或者助教端\n\t\t// 'ignoreEnd' : false//是否忽略暂停命令,一般用于教师端或者助教端\n\t\tvar mainPlayerId = _this.options.modules.player.mianPlayerBox;\n\t\tvar auxPlayerId = _this.options.modules.player.auxPlayerBox;\n\t\tvar ignoreSuspend = _this.options.modules.player.ignoreSuspend;\n\t\tvar ignoreEnd = _this.options.modules.player.ignoreEnd;\n\n\t\tif (!mainPlayerId) {\n\t\t\t_this.debugLog('options.modules.player.mianPlayerBox is not defined ');\n\t\t\treturn false;\n\t\t}\n\t\t// 获取鉴权的媒体参数\n\t\tvar signedMedia = _getSignedMediaWithGroup();\n\t\t\n\t\t_signedRoomMedia = signedMedia;\n\t\tvar paltformType = signedMedia['paltformType'];\n\t\tvar isMobile = _this.tools.isMobile();\n\n\t\tvar $mainPlayer = $('#' + mainPlayerId);\n\t\tvar $auxPlayer = $('#' + auxPlayerId);\n\n\t\tvar innerMainPlayerId = mainPlayerId + '_inner';\n\t\tvar innerAuxPlayerId = mainPlayerId + '_inner';\n\n\t\tvar $mainPlayerInner = $mainPlayer.find('.inner');\n\t\tif ($mainPlayerInner.length == 0) {\n\t\t\tvar $inner = $('<div/>');\n\t\t\t$inner.attr('class', 'inner');\n\t\t\t$inner.attr('id', innerMainPlayerId);\n\t\t\t$inner.css({\n\t\t\t\t'height': '100%',\n\t\t\t\t'width': '100%',\n\t\t\t\t'cursor': 'pointer'\n\t\t\t});\n\t\t\t$mainPlayer.append($inner);\n\t\t\t$mainPlayerInner = $mainPlayer.find('.inner');\n\t\t}\n\n\t\tvar $innerAuxPlayer = $auxPlayer.find('.inner');\n\t\tif ($innerAuxPlayer.length == 0) {\n\t\t\tvar $inner = $('<div/>');\n\t\t\t$inner.attr('class', 'inner');\n\t\t\t$inner.attr('id', innerAuxPlayerId);\n\t\t\t$auxPlayer.append($inner);\n\t\t\t$innerAuxPlayer = $auxPlayer.find('.inner');\n\t\t}\n\t\t\n\t\t//根据状态获取背景\n\t\tvar bg = _this.options.modules.player.mianPlayerBoxBackground;\n\t\tvar bgImg = _lmcBase.serverConfig.resourceCdn + '/images/placeholder/player_bg_' + _status.liveStatus + '.png';\n\t\tif(bg && bg[_status.liveStatus]){\n\t\t\tbgImg = bg[_status.liveStatus];\n\t\t}\n\n\t\t$mainPlayer.css({\n\t\t\t'background' : 'url(\"'+bgImg+'\") no-repeat scroll 0 0 / 100% 100%'\n\t\t});\n\n\t\tif(_status.liveStatus == 'end'){\n\t\t\t\n\t\t\tvar targetPlaybackMedia = null;\n\t\t\tvar signedPlaybackMedias = _lmcBase.room.signedRoomPlaybackMedias;\n\t\t\tif(signedPlaybackMedias && signedPlaybackMedias.length){\n\t\t\t\ttargetPlaybackMedia = signedPlaybackMedias[0];\n\t\t\t}\n\t\t\t\n\t\t\tvar playbackPaltformType = null;\n\t\t\tif(targetPlaybackMedia != null){\n\t\t\t\t$mainPlayer.show();\n\t\t\t\t$mainPlayerInner.show();\n\t\t\t\tplaybackPaltformType = targetPlaybackMedia.playbakcPlatformType;\n\t\t\t\t// pc端处理逻辑\n\t\t\t\tif ('aliyun' == playbackPaltformType) {\n\t\t\t\t\tvar opt = {\n\t\t\t\t\t\t\tisLive : false,\n\t\t\t\t\t\t\tisMobile : isMobile,\n\t\t\t\t\t\t\t$mainPlayerInner : $mainPlayerInner,\n\t\t\t\t\t\t\tmobileVedioType : '->application/octet-stream',\n\t\t\t\t\t\t\tinnerMainPlayerId : innerMainPlayerId,\n\t\t\t\t\t\t\tpaltformType : playbackPaltformType\n\t\t\t\t\t};\n\t\t\t\t\tvar playList = targetPlaybackMedia.playList;\n\t\t\t\t\t\n\t\t\t\t\tvar mobileUrl = '';\n\t\t\t\t\tvar pcUrls = [];\n\t\t\t\t\t\n\t\t\t\t\t//按照码率进行排序\n\t\t\t\t\tplayList.sort(function(a,b){\n\t\t\t\t\t\treturn b.bitrate - a.bitrate;\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tfor(var i in playList){\n\t\t\t\t\t\tvar play = playList[i];\n\t\t\t\t\t\tif(play.format == 'mp4'){\n\t\t\t\t\t\t\tpcUrls.push(play.url);\n\t\t\t\t\t\t\tmobileUrl = play.url;\n\t\t\t\t\t\t}else if(play.format == 'm3u8'){\n\t\t\t\t\t\t\tpcUrls.push(play.url);\n\t\t\t\t\t\t\tmobileUrl = play.url;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\topt.mobileUrl = mobileUrl;\n\t\t\t\t\topt.pcUrls = pcUrls;\n\t\t\t\t\t_useAliyunPlay(opt);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif ('aliyun' == paltformType) {\n\t\t\t\t\tif (isMobile) {\n\t\t\t\t\t\t$mainPlayerInner.hide();\n\t\t\t\t\t\tvar $video = $mainPlayerInner.find('video');\n\t\t\t\t\t\tif ($video && $video.length > 0) {\n\t\t\t\t\t\t\tvar video = $video.get(0);\n\t\t\t\t\t\t\tvideo.pause();\n\t\t\t\t\t\t\t$video.attr('src', 'undefined');\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$mainPlayerInner.remove();\n\t\t\t\t\t}\n\t\t\t\t} else if ('huantuo' == paltformType) {\n\t\t\t\t\t$mainPlayerInner.hide();\n\t\t\t\t\tvar _MT = _innerContainer[paltformType + 'SDK_MAIN'];\n\t\t\t\t\tif (!_MT) {\n\t\t\t\t\t\t_MT.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t} else if (_status.liveStatus == 'start' || (_status.liveStatus == 'wait' && ignoreSuspend) || (_status.liveStatus == 'suspend' && ignoreSuspend)) {\n\t\t\t// 如果处于开始状态,\n\t\t\t$mainPlayer.show();\n\t\t\t$mainPlayerInner.show();\n\t\t\t// pc端处理逻辑\n\t\t\tif ('aliyun' == paltformType) {\n\t\t\t\tvar opt = {\n\t\t\t\t\tisLive : true,\n\t\t\t\t\tisMobile : isMobile,\n\t\t\t\t\t$mainPlayerInner : $mainPlayerInner,\n\t\t\t\t\tmobileVedioType : '->application/x-mpegURL',\n\t\t\t\t\tinnerMainPlayerId : innerMainPlayerId,\n\t\t\t\t\tpaltformType : paltformType\n\t\t\t\t};\n\t\t\t\tvar mobileUrl = '';\n\t\t\t\tvar pcUrls = [];\n\t\t\t\tvar FLV_URL = signedMedia.FLV_URL\n\t\t\t\tpcUrls.push(FLV_URL);\n\t\t\t\tpcUrls.push(signedMedia.HD_RTMP_URL);\n\t\t\t\tpcUrls.push(signedMedia.SD_RTMP_URL);\n\t\t\t\topt.mobileUrl = signedMedia.M3U8_URL;\n\t\t\t\topt.pcUrls = pcUrls;\n\t\t\t\t_useAliyunPlay(opt);\n\t\t\t} else if ('huantuo' == paltformType) {\n\t\t\t\t// 欢拓\n\t\t\t\tvar huantuo_cdn = 'http://static-1.talk-fun.com/open';\n\t\t\t\tvar huantuo_js = '';\n\t\t\t\tif (isMobile) {\n\t\t\t\t\t// http://static-1.talk-fun.com/open/maituo_v2/dist/live/mobile/h5/sdk-mobile.2.5.min.js?v=117114\n\t\t\t\t\thuantuo_js = '/maituo_v2/dist/sdk-mobile.min.js';\n\t\t\t\t} else {\n\t\t\t\t\thuantuo_js = '/maituo_v2/dist/sdk-pc.min.js';\n\t\t\t\t}\n\t\t\t\t_this.loadScript([ huantuo_cdn + huantuo_js ], function() {\n\t\t\t\t\t// 创建SDK对象\n\t\t\t\t\tvar huantuo_auxPlayer = paltformType + '_auxPlayer';\n\t\t\t\t\tvar huantuo_mainPlayer = paltformType + '_mainPlayer';\n\t\t\t\t\t$('#' + innerAudioPlayerId).show();\n\t\t\t\t\t$('#' + innerAuxPlayerId).show();\n\t\t\t\t\tvar _MT = _innerContainer[paltformType + 'SDK_MAIN'];\n\t\t\t\t\tvar access_token = signedMedia['data']['access_token'];\n\t\t\t\t\tif (!_MT) {\n\t\t\t\t\t\t_MT = new MT.SDK.main(access_token);\n\t\t\t\t\t\t_innerContainer[paltformType + 'SDK_MAIN'] = _MT;\n\t\t\t\t\t\t_MT.camera(innerAuxPlayerId, huantuo_auxPlayer,\n\t\t\t\t\t\t\t\tfunction(camera) {\n\t\t\t\t\t\t\t\t\t_this.debugLog('辅助播放器加载完成！');\n\t\t\t\t\t\t\t\t\t$(camera).hide();\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t_MT.mainPlayer(innerMainPlayerId, huantuo_mainPlayer,\n\t\t\t\t\t\t\t\tfunction(player) {\n\t\t\t\t\t\t\t\t\t_this.debugLog(\"主播放器加载完成！\");\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t} else if (_status.liveStatus == 'wait') {\n\t\t} else if (_status.liveStatus == 'suspend') {\n\t\t\tif ('aliyun' == paltformType) {\n\t\t\t\tif (isMobile) {\n\t\t\t\t\t$mainPlayerInner.hide();\n\t\t\t\t\tvar $video = $mainPlayerInner.find('video');\n\t\t\t\t\tif ($video && $video.length > 0) {\n\t\t\t\t\t\tvar video = $video.get(0);\n\t\t\t\t\t\tvideo.pause();\n\t\t\t\t\t\t$video.attr('src', 'undefined');\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$mainPlayerInner.remove();\n\t\t\t\t}\n\t\t\t} else if ('huantuo' == paltformType) {\n\t\t\t\t$mainPlayerInner.hide();\n\t\t\t\tvar _MT = _innerContainer[paltformType + 'SDK_MAIN'];\n\t\t\t\tif (!_MT) {\n\t\t\t\t\t_MT.stop();\n\t\t\t\t}\n\t\t\t}\n\t\t} \n\t\t\n\t\t// 检查音频播放器\n\t\t_checkAudioPlayerImpl();\n\t}\n\n\t/**\n\t * 检查背景音乐播放器实现\n\t */\n\tvar _checkBgMusicPlayerImpl = function(){\n\t\tif(_status.bgmusic == 'play'){\n\t\t\tif(_status.liveStatus == 'wait' || _status.liveStatus == 'suspend'){\n\t\t\t\tvar audioUrl = _getCmdData('bgmusic',true);\n\t\t\t\tif(audioUrl){\n\t\t\t\t\t_this.playAudio({\n\t\t\t\t\t\tstatus : 'play',\n\t\t\t\t\t\turl : audioUrl,\n\t\t\t\t\t\tloop : true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}else if(_status.bgmusic == 'stop'){\n\t\t\t_this.playAudio({\n\t\t\t\tstatus : 'ended'\n\t\t\t});\n\t\t}\n\t}\n\t/**\n\t * 检查音频播放器\n\t */\n\tvar _checkAudioPlayerImpl = function() {\n\t\tvar audioPlayerId = _this.options.modules.player.audioPlayerBox;\n\t\tvar $audioPlayer = $('#' + audioPlayerId);\n\t\tvar innerAudioPlayerId = audioPlayerId + '_inner';\n\t\tvar $innerAudioPlayer = $audioPlayer.find('.inner');\n\t\tif ($innerAudioPlayer.length == 0) {\n\t\t\tvar $inner = $('<div/>');\n\t\t\t$inner.attr('class', 'inner');\n\t\t\t$inner.attr('id', innerAudioPlayerId);\n\t\t\t$audioPlayer.append($inner);\n\t\t\t$innerAudioPlayer = $audioPlayer.find('.inner');\n\t\t\tvar audio = '<audio></audio>';\n\t\t\t$innerAudioPlayer.append(audio);\n\t\t}\n\t\tvar $audio = $innerAudioPlayer.find('audio');\n\t\t\n\t\tvar audio = $audio.get(0);\n\t\tif(!audio){\n\t\t\treturn false;\n\t\t}\n\t\taudio.addEventListener('play', function() {\n\t\t\t_this.tools.callFunction('onAudioPlayerStatuChange',  _notify, {\n\t\t\t\t'url' : audio.src,\n\t\t\t\t'status' : 'play'\n\t\t\t});\n\t\t}, false);\n\t\taudio.addEventListener('pause', function() {\n\t\t\t_this.tools.callFunction('onAudioPlayerStatuChange', _notify, {\n\t\t\t\t'url' : audio.src,\n\t\t\t\t'status' : 'pause'\n\t\t\t});\n\t\t}, false);\n\t\taudio.addEventListener('ended', function() {\n\t\t\t_this.tools.callFunction('onAudioPlayerStatuChange',  _notify, {\n\t\t\t\t'url' : audio.src,\n\t\t\t\t'status' : 'ended'\n\t\t\t});\n\t\t}, false);\n\t\t\n\t\treturn $audio;\n\t}\n\t\n\t\n\t/**\n\t * 使用阿里云播放器播放视频\n\t */\n\tvar _useAliyunPlay = function(opt){\n\t\tvar isLive = opt.isLive || false;\n\t\tvar isMobile = opt.isMobile || false;\n\t\tvar $mainPlayerInner = opt.$mainPlayerInner;\n\t\tvar mobileVedioType = opt.mobileVedioType || '->application/x-mpegURL';\n\t\tvar innerMainPlayerId = opt.innerMainPlayerId;\n\t\tvar paltformType = opt.paltformType;\n\t\t\n\t\tvar ckplayerJsPath = '/platform/ckplayer6.8/ckplayer/ckplayer.js';\n\t\tif(!isLive){\n\t\t\tckplayerJsPath = '/platform/ckplayer6.8/ckplayer/ckplayer_playback.js';\n\t\t}\n\t\t\n\t\t_this.loadScript(_lmcBase.serverConfig.resourceCdn + ckplayerJsPath,\n\t\t\tfunction() {\n\t\t\t\twindow.loadedHandler = function() {\n\t\t\t\t\t$mainPlayerInner.css({\n\t\t\t\t\t\t'height' : '100%',\n\t\t\t\t\t\t'width' : '100%'\n\t\t\t\t\t});\n\t\t\t\t\tvar $video = $mainPlayerInner.find('video');\n\t\t\t\t\tif ($video && $video.length > 0) {\n\t\t\t\t\t\t$video.css({\n\t\t\t\t\t\t\t'z-index' : '100'\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$video.attr('x-webkit-airplay','true');\n\t\t\t\t\t\t$video.attr('webkit-playsinline','true');\n\t\t\t\t\t\tvar video = $video.get(0);\n\t\t\t\t\t\tvideo.addEventListener('pause',function(e) {\n\t\t\t\t\t\t\tif (this.webkitExitFullscreen) {\n\t\t\t\t\t\t\t\tthis.webkitExitFullscreen();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\n\t\t\t\tvar pcUrls = opt.pcUrls;\n\t\t\t\tvar defaultUrl = pcUrls[0];\n\t\t\t\tvar deff = '';\n\t\t\t\tvar first = true;\n\t\t\t\tfor(var i in pcUrls){\n\t\t\t\t\tif(first){\n\t\t\t\t\t\tfirst = false;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tdeff += '|';\n\t\t\t\t\t}\n\t\t\t\t\tdeff += pcUrls[i];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar v = _this.options.appConfig.volume == null ? 0 : _this.options.appConfig.volume\n\t\t\t\tvar flashvars={\n\t\t\t\t\ta : '',\n\t\t\t\t\tb : '0',\n\t\t\t\t\tc : 0,\n\t\t\t\t\tdeff: deff,\n\t\t\t\t\tf : defaultUrl,\n\t\t\t\t\th : '3',\n\t\t\t\t\tp : '1',\n\t\t\t\t\tlv : isLive ? '1' : '0',\n\t\t\t\t    v : v,\n\t\t\t\t\tloaded : 'loadedHandler'\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tif(!isLive){\n\t\t\t\t\tvar isM3u8 = false;\n\t\t\t\t\tvar defaultUrlSubs = defaultUrl.split('?');\n\t\t\t\t\tif(defaultUrlSubs && defaultUrlSubs.length > 0){\n\t\t\t\t\t\tisM3u8 = defaultUrlSubs[0].lastIndexOf('.m3u8') == (defaultUrlSubs[0].length - 5)\n\t\t\t\t\t}\n\t\t\t\t\tif(isM3u8){\n\t\t\t\t\t\tflashvars['a'] = defaultUrl;\n\t\t\t\t\t\tflashvars['f'] = _lmcBase.serverConfig.resourceCdn +  '/platform/ckplayer6.8/plugins/m3u8/m3u8.swf';\n\t\t\t\t\t\tflashvars['s'] = 4;\n\t\t\t\t\t\tflashvars['c'] = 0;\n\t\t\t\t\t\tflashvars['deff'] = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar video = [];\n\t\t\t\tif (isMobile) {\n\t\t\t\t\tvar $video = $mainPlayerInner.find('video');\n\t\t\t\t\tif ($video && $video.length > 0) {\n\t\t\t\t\t\t$mainPlayerInner.empty();\n\t\t\t\t\t}\n\t\t\t\t\tvideo.push(opt.mobileUrl + mobileVedioType);\n\t\t\t\t}\n\t\t\t\tvar params={bgcolor:'#FFF',allowFullScreen:true,allowScriptAccess:'always',wmode:'transparent'};\n\t\t\t\tCKobject.embed(_lmcBase.serverConfig.resourceCdn + '/platform/ckplayer6.8/ckplayer/ckplayer.swf',\n\t\t\t\t\t\tinnerMainPlayerId,\n\t\t\t\t\t\tpaltformType + 'ckplayer_mian',\n\t\t\t\t\t\t'100%', '100%', false,\n\t\t\t\t\t\tflashvars, video, params);\n\t\t\t\n\t\t});\n\t}\n\t\n\t\n\t/**\n\t * 显示错误页面\n\t * @param type 错误类型\n\t * @param message 错误消息\n\t */\n\tvar _showError = function(type,message){\n\t\tvar mainPlayerId = _this.options.modules.player.mianPlayerBox;\n\t\tvar $mainPlayer = $('#' + mainPlayerId);\n\t\t$mainPlayer.find('video').attr('src','undefined');\n\t\t\n\t\tvar page = null;\n\t\tif(type == 'repeat'){\n\t\t\tpage = _this.options.appConfig.repeatPage;\n\t\t}else if(type == 'timeout'){\n\t\t\tpage = _this.options.appConfig.timeoutPage;\n\t\t}else {\n\t\t\tpage = _this.options.appConfig.errorPage;\n\t\t}\n\t\t$('body').empty();\n\t\tif (page) {\n\t\t\twindow.location.href = page;\n\t\t}else{\n\t\t\talert(message);\n\t\t}\n\t\t\n\t}\n\t/**\n\t * 工具函数\n\t */\n\tthis.tools = new LmcTools();\n\t/**\n\t * 即时通讯\n\t */\n\tthis.im = new LmcIm();\n\n\t/**\n\t * 控制器配置选项\n\t */\n\tthis.options = {\n\t\t'appConfig' : {// 应用配置\n\t\t\t'lmcServer' : '/lmc/core',// 直播媒体中心服务器地址,\n\t\t\t'cacheJs' : false, // 是否缓存JavaScript文件,默认不缓存,\n\t\t\t'appId' : null,// 应用id\n\t\t\t'appSign' : null,// 应用授权签名,\n\t\t\t'expire' : 0, //鉴权到期时间\n\t\t\t'random' : null, //鉴权随机字符串\n\t\t\t'debug' : false, // 是否需要调试,\n\t\t\t'errorPage' : null, // 加载错误页面,\n\t\t\t'repeatPage' : null, // 重复登录错误页面,\n\t\t\t'timeoutPage' : null, // 鉴权超时错误页面\n\t\t\t'volume' : 80 // 默认音量\n\t\t},\n\t\t'liveConfig' : {// 直播配置\n\t\t\t'roomId' : null\n\t\t// 直播间id,\n\t\t},\n\t\t'userConfig' : {// 用户配置\n\t\t\t'userId' : null,// 用户身份标识\n\t\t\t'nickname' : null,// 用户身份标识\n\t\t\t'headerUrl' : null,// 用户头像路径\n\t\t\t'role' : 'student',// ['teacher','assistant','student'] 用户权限，可以自行扩展\n\t\t\t'subGroupId' : '1',// 用户分组id,如果所属多个分则用逗号分隔,如果属于全部组则subGroupId为ALL\n\t\t\t'onlyGroupMsg' : true,// 仅仅接收同组消息\n\t\t\t'repeatLogin' : false,// 是否允许重复登录,默认不允许\n\t\t\t'onRepeatlogin' : null,// 配置重复登录时的处理函数\n\t\t\t'extData' : null //用户扩展数据\n\t\t// 设置用户是否只显示组内消息\n\t\t},\n\t\t'modules' : { // 模块配置\n\t\t\t'notify' : { // 回调通知模块\n\t\t\t\t'onUserJoin' : null, // 当用户进入直播间\n\t\t\t\t'onUserOffline' : null,//用户从直播间离线\n\t\t\t\t'onUserChange' : null, // 当用户进入直播间\n\t\t\t\t'onInitCompleted' : null,// 当组件初始化完成\n\t\t\t\t'onGetPoint' : null,//当用户获得积分时回调\n\t\t\t\t'onPollingTrigger' : null,// 直播间轮询状态触发,每一秒触发一次\n\t\t\t\t'onImCustomArrive' : null, // 当自定义消息到达时回调\n\t\t\t\t'onCommandArrive' : null, // 当命令消息到达时回调\n\t\t\t\t'onPrivateMsgArrive' : null,//当私聊消息到达时回调\n                'onImTextMsgArrive' : null, // 当文本消息到达时回调\n\t\t\t\t'onWithdrawArrive' : null,//当消息撤回指令到达时回调\n\t\t\t\t'onUserStatusChange' : null, // 当用户状态变化时回调\n\t\t\t\t'onMediaPlayerStatusChange' : null, // 当媒体播放器状态变化时回调\n\t\t\t\t'onLiveStatusChange' : null, // 当直播状态变化时回调\n\t\t\t\t'onImTextMsgSend' : null,// 当发送普通消息时回调\n\t\t\t\t'onCustomMsgSend' : null,// 当发送自定义消息时回调\n\t\t\t\t'onCustomMsgRejected' : null,//当发送自定义消息被拒绝时回调\n\t\t\t\t'onCommandSend' : null,// 当发送命令消息时回调\n\t\t\t\t'onError' : null, // 当系统错误发生时回调\n\t\t\t\t'onNetworkError' : null, //当网络错误发生时回调\n\t\t\t\t'onOrientationChange' : null,//当屏幕方向改变时触发,在初始化时会触发\n\t\t\t\t'onAudioPlayerStatuChange' : null //当音频播放器的状态发生变化时回调\n\t\t\t// 当发生错误或者异常时回调\n\t\t\t},\n\t\t\t'player' : { // 播放器模块\n\t\t\t\t'mianPlayerBox' : 'mianPlayerBox',// 主播放器容器id(主播放器用于播放推流视频和推流白板)\n\t\t\t\t'mianPlayerBoxBackground' : null ,// 主播放器背景填充\n\t\t\t\t'auxPlayerBox' : 'auxPlayerBox',// 辅助放器容器id(辅助播放器用于播放广告,摄像头等)\n\t\t\t\t'audioPlayerBox' : 'audioPlayerBox',// 主播放器容器id(音频播放器用于播放一般声音,暖场音频等)\n\t\t\t\t'ignoreSuspend' : false,// 是否忽略暂停命令,一般用于教师端或者助教端\n\t\t\t\t'ignoreEnd' : false\n\t\t\t// 是否忽略暂停命令,一般用于教师端或者助教端\n\t\t\t},\n\t\t\t'im' : {// 即时通信模块\n\t\t\t\t'onlyGroupMsg' : true,// 是否只显示本组消息\n\t\t\t\t'voiceBtn' : 'voiceBtn',// 弹出语音功能的按钮\n\t\t\t\t'useBarrage' : false,//使用弹幕\n\t\t\t\t'reverseHistoryMsg' : true,//将历史反向排序\n\t\t\t\t'emojis' : {// emoji表情符号\n\t\t\t\t\t'append' : true,// 自定义的表情是否添加到系统自带表情之后,如为false将清除原有表情\n\t\t\t\t\t'emojiTextTemplate' : '[${content}]',// emoji表情转为文字的模板\n\t\t\t\t\t'maxWidth' : '32px',//表情最大宽度\n\t\t\t\t\t'maxHeight' : '32px',//表情最大高度\n\t\t\t\t\t'imgs' : {// [{//表情图片数据'表情名' : url','表情2' : url2'} ]\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\n\t/**\n\t * 日志输出\n\t */\n\tthis.debugLog = function(_log) {\n\t\tif (this.options.appConfig.debug) {\n\t\t\tthis.tools.debugLog(_log);\n\t\t}\n\t}\n\n\t/**\n\t * load script 代理\n\t */\n\tthis.loadScript = function(url, callback) {\n\t\tthis.tools.loadScript(url, callback, this.options.appConfig.cacheJs);\n\t}\n\n\t/**\n\t * 直播初始化\n\t * \n\t * @param options {\n\t *            'lmcServer' : 'http://testwx.teacherv.top',// 直播媒体中心服务器地址,\n\t *            'cacheJs' : false, // 是否缓存JavaScript文件,默认不缓存, 'appId' :\n\t *            '0000001',// 应用id 'appSign' : 'xxxxxxxxxxxxxx'// 应用授权签名\n\t *            'roomId' : '00000001',//直播间id 'userId' : '00000001',//用户身份标识\n\t *            'nickname' : '00000001',//用户身份标识 'role' :\n\t *            'student',//['teacher','assistant','student'],用户权限,默认为三种权限,但是权限对应的操作用户可以自行扩展 }\n\t */\n\tthis.init = function(_options) {\n\t\tif(!$ && !jQuery){\n\t\t\talert('请加载jquery库');\n\t\t}\n\t\t_this.tools.mergeData(_this.options, _options);\n\n\t\t_this.debugLog('options');\n\t\t_this.debugLog(_this.options);\n\t\t\n\t\t//检查falsh插件的支持情况\n\t\tif(!_this.tools.isMobile()){\n\t\t\tvar supportFlush = true;\n\t\t\tif (typeof window.ActiveXObject != \"undefined\") {\n\t\t\t\ttry {\n\t\t\t\t\tsupportFlush = Boolean(new ActiveXObject('ShockwaveFlash.ShockwaveFlash'));\n\t\t\t\t} catch(exception) {\n\t\t\t\t\tsupportFlush = ('undefined' != typeof navigator.mimeTypes['application/x-shockwave-flash']);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tsupportFlush = !!navigator.plugins['Shockwave Flash'];\n\t\t\t}\n\t\t\tif(!supportFlush){\n\t\t\t\tvar updateFlash = window.confirm('您的浏览器不支持Flash,请更新后重启浏览器');\n\t\t\t\tif(updateFlash){\n\t\t\t\t\twindow.location.href = 'https://get2.adobe.com/cn/flashplayer/';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// 加载直播间配置\n\t\t_this.loadConfig({\n\t\t\t'success' : function(lmcBase) {// 加载成功回调\n\t\t\t\t// 初始化im(im是必选模块)\n//\t\t\t\tvar imOptions = {};\n\t\t\t\t_this.debugLog(lmcBase);\n\t\t\t\t_lmcBase = lmcBase;\n\n\t\t\t\tif (!_lmcBase.serverConfig) {\n\t\t\t\t\t_lmcBase.serverConfig = {};\n\t\t\t\t}else{\n                    if( _lmcBase.serverConfig.resourceCdn && _lmcBase.serverConfig.resourceCdn.indexOf(\"https://\")  === -1 ){\n                        _lmcBase.serverConfig.resourceCdn = _lmcBase.serverConfig.resourceCdn.replace(\"http://\", \"https://\");\n                    }\n                }\n\t\t\t\tif (!_lmcBase.imConfig) {\n\t\t\t\t\t_lmcBase.imConfig = {};\n\t\t\t\t}\n\t\t\t\tif (!_lmcBase.messageConfigs) {\n\t\t\t\t\t_lmcBase.messageConfigs = [];\n\t\t\t\t}\n\t\t\t\tif (!_lmcBase.pointConfigs) {\n\t\t\t\t\t_lmcBase.pointConfigs = [];\n\t\t\t\t}\n\t\t\t\tif (!_lmcBase.extDatas) {\n\t\t\t\t\t_lmcBase.extDatas = [];\n\t\t\t\t}\n\t\t\t\tif (!_lmcBase.cmdDatas) {\n\t\t\t\t\t_lmcBase.cmdDatas = [];\n\t\t\t\t}\n\t\t\t\tif (!_lmcBase.usesrCounts) {\n\t\t\t\t\t_lmcBase.usesrCounts = [];\n\t\t\t\t}\n\t\t\t\tif (!_lmcBase.userList) {\n\t\t\t\t\t_lmcBase.userList = [];\n\t\t\t\t}\n\t\t\t\tif (!_lmcBase.selfCustomMessageList) {\n\t\t\t\t\t_lmcBase.selfCustomMessageList = {};\n\t\t\t\t}\n\t\t\t\tif (!_lmcBase.customMessageCount) {\n\t\t\t\t\t_lmcBase.customMessageCount = [];\n\t\t\t\t}\n\t\t\t\tif(!_lmcBase.userPointCount){\n\t\t\t\t\t_lmcBase.userPointCount = [];\n\t\t\t\t}\n\t\t\t\t// 初始化信息赋值\n\t\t\t\t_notify = _this.options.modules.notify;\n\n\t\t\t\t//TODO 版本兼容控制,再下一次版版本发布时删除\n\t\t\t\tif(!_notify.onImTextMsgArrive){\n                    _notify.onImTextMsgArrive = _this.options.modules.im.chatItemRender;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 初始化命令\n\t\t\t\t_this.initCmdData();\n\n\t\t\t\tif(_this.tools.isMobile() && !(typeof window.orientation == 'undefined')){\n\t\t\t\t\t_this.tools.callFunction('onOrientationChange', _notify, (window.orientation % 180 == 0) ? 'vertical' : 'horizontal' );\n\t\t\t\t\twindow.addEventListener(\"orientationchange\", function() {\n\t\t\t\t\t\t_this.tools.callFunction('onOrientationChange', _notify, (window.orientation % 180 == 0) ? 'vertical' : 'horizontal' );\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\t'error' : function(url) {// 加载成功回调\n\t\t\t\t_this.debugLog('加载脚本错误:' + url);\n\t\t\t}\n\t\t});\n\n\t\t//状态轮询\n\t\tsetInterval(_pollingTrigger, 1000);\n\t\t//时间修正同步\n\t\tsetInterval(_timeCorrect, 1000);\n\t\t//修正在线用户数量修正同步,每分钟修正一次\n\t\tsetInterval(_userCountCorrect, 60000);\n\t}\n\n\t/**\n\t * 加载直播间配置\n\t * \n\t * @param 加载参数\n\t */\n\tthis.loadConfig = function(param) {\n\t\t_requestLmcData({\n\t\t\t'action' : 'init',\n\t\t\t'data' : {\n\t\t\t\t'nickname' : _this.options.userConfig.nickname,\n\t\t\t\t'headerUrl' : _this.options.userConfig.headerUrl\n\t\t\t},\n\t\t\t'success' : function(json) {\n\t\t\t\tif(!json || json.error){\n\t\t\t\t\tvar type = '';\n\t\t\t\t\tvar message = '';\n\t\t\t\t\tif(json.code == 'paramError'){\n\t\t\t\t\t\tif(json.message == 'appSign is overdue'){\n\t\t\t\t\t\t\ttype = 'timeout';\n\t\t\t\t\t\t\tmessage = '试听结束';\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tmessage = '参数错误 ' + (json.message || '');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t_showError(type, message);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tvar _config = json;\n\t\t\t\t_this.debugLog('lmcData : ');\n\t\t\t\t_this.tools.callFunction('success', param, _config);\n\t\t\t},\n\t\t\t'error' : function(xhr) {\n\t\t\t\t_this.tools.callFunction('onError', {\n\t\t\t\t\t'type' : 'getLmcConfigError'\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * 初始化im，在直播时必须加载im模块\n\t * \n\t * @param 加载参数\n\t */\n\tthis.initIm = function(param) {\n\t\t_this.debugLog(param);\n\t\tvar cdn = param.resourceCdn;\n\t\tvar urls = [ cdn + '/platform/tls/sdk/webim.js', cdn + '/platform/tls/sdk/json2.js', cdn + '/js/im/tls/base.js' ];\n\t\t_this.loadScript(urls, function(success) {\n\t\t\t_this.debugLog('初始化im完成:' + success);\n\t\t\tif (!success) {\n\t\t\t\talert('加载错误,请刷新重试'+ _this.tools.jsonStringify(urls));\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// 初始化im\n\t\t\t_this.im.init(param);\n\n            // 初始化文本消息列表\n           /* _this.initTextMessageList();*/\n\t\t});\n\t}\n\n\t/**\n\t * \n\t * 初始化媒体播放器模块\n\t * \n\t * @param 加载参数\n\t */\n\tthis.initMediaPlayer = function(param) {\n\t\t_this.debugLog(param);\n\t\t_this.checkMediaPlayer();\n\t}\n\t\n\t/**\n\t * \n\t * 初始化媒体播放器模块\n\t * \n\t * @param 加载参数\n\t */\n\tthis.initBgmusicPlayer = function(param) {\n\t\t_this.debugLog(param);\n\t\t_this.checkBgMusicPlayer();\n\t}\n\t\n\n\t/**\n\t * 初始化扩展数据列表\n\t */\n\tthis.initExtDataList = function(){\n\t\t_requestLmcData({\n\t\t\t'action' : 'getExtDataList',\n\t\t\t'success' : function(json) {\n\t\t\t\tif (!json.error && json.length > 0) {\n\t\t\t\t\t_this.tools.callFunction('onExtDataListInit',_notify, json);\n\t\t\t\t}\n\t\t\t},\n\t\t\t'error' : function(err) {\n\t\t\t}\n\t\t});\n\t}\n\t\n\t/**\n\t * 初始化用户列表\n\t */\n\tthis.initUserList = function(){\n\t\t_requestLmcData({\n\t\t\t'action' : 'getUserList',\n\t\t\t'success' : function(json) {\n\t\t\t\tif (!json.error && json.data && json.data.length > 0) {\n\t\t\t\t\tfor(var i in json.data){\n\t\t\t\t\t\tif(!json.data[i].nickname){\n\t\t\t\t\t\t\tjson.data[i].nickname = '匿名用户';\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_pushUserToContainer(json.data[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// 初始化im模块\n\t\t\t\t_this.initIm(_imOptions);\n\t\t\t},\n\t\t\t'error' : function(err) {\n\t\t\t}\n\t\t});\n\t}\n\t\n\t\n\t/**\n\t * 初始化自定义消息\n\t */\n\tthis.initCustomMessage = function(){\n\t\t_requestLmcData({\n\t\t\t'action' : 'getCustomMessage',\n\t\t\t'success' : function(json) {\n\t\t\t\tif(!json || json.error || !json.data){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar selfCustomMessage = json.data.selfCustomMessageCount;\n\t\t\t\tif (selfCustomMessage && selfCustomMessage.length > 0) {\n\t\t\t\t\tfor(var i in selfCustomMessage){\n\t\t\t\t\t\tvar item = selfCustomMessage[i];\n\t\t\t\t\t\tvar id = item.id;\n\t\t\t\t\t\tvar finalId = item.userId + '_' + id.customType + '_' + id.flag;\n\t\t\t\t\t\titem.id = finalId;\n//\t\t\t\t\t\t_pushUserToContainer(item);\n\t\t\t\t\t\t_lmcBase.selfCustomMessageList[item.id] = item;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar customMessageCount = json.data.customMessageCount;\n\t\t\t\tif (customMessageCount && customMessageCount.length > 0) {\n\t\t\t\t\tfor(var i in customMessageCount){\n\t\t\t\t\t\t_lmcBase.customMessageCount.push(customMessageCount[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t'error' : function(err) {\n\t\t\t}\n\t\t});\n\t}\n\n\n    /**\n     * 初始化文本消息列表\n     */\n    this.initTextMessageList = function(){\n      _this.loadHistoryTextMessage(function(){\n          _status.historyMsgLoadComplete = true;\n\t  });\n    }\n\n\n\t/**\n\t * 初始化命令数据\n\t */\n\tthis.initCmdData = function(){\n\t\t_requestLmcData({\n\t\t\t'action' : 'getCmdData',\n\t\t\t'success' : function(json) {\n\t\t\t\tif(json && !json.error){\n\t\t\t\t\tvar imOptions = {};\n\t\t\t\t\t_lmcBase.cmdDatas = json;\n\t\t\t\t\t\n\t\t\t\t\t// 刷新所有状态\n\t\t\t\t\t_flushStatus();\n\n\t\t\t\t\tvar imConfig = {\n\t\t\t\t\t\t'userId' : _this.options.userConfig.userId,\n\t\t\t\t\t\t'appId' : _this.options.appConfig.appId,\n\t\t\t\t\t\t'identifier' : _lmcBase.room.conf.identifier,\n\t\t\t\t\t\t'userSign' : _lmcBase.room.conf.imSign,\n\t\t\t\t\t\t'sdkAppID' : _lmcBase.room.conf.imsdkAppID,\n\t\t\t\t\t\t'accountType' : _lmcBase.room.conf.imAccountType,\n\t\t\t\t\t\t'avChatRoomId' : _lmcBase.imConfig.imPlatformParam.avChatRoomId\n\t\t\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\t//用户属性\n\t\t            var slef = {\n\t\t              'userId' : _this.options.userConfig.userId,\n\t\t        \t  'nickname' : _this.options.userConfig.nickname,\n\t\t  \t\t\t  'headerUrl' : _this.options.userConfig.headerUrl,\n\t\t  \t\t\t  'role' : _this.options.userConfig.role,\n\t\t  \t\t\t  'subGroupId' : _this.options.userConfig.subGroupId,\n\t\t  \t\t\t  'pointValue' : _lmcBase.userPointValue || 0,\n\t\t  \t\t\t  'lastLoginTime' : _status.serverTime,\n\t\t  \t\t\t  'extData' : _this.options.userConfig.extData\n\t\t            };\n\t\t            \n\t\t            //用户登录时保存自己的属性\n\t\t            _pushUserToContainer(slef);\n\t\t\t\t\t\n\t\t\t\t\t_lmcBase.serverConfig.resourceCdn = _lmcBase.serverConfig.resourceCdn || '';\n\t\t\t\t\t_heartbeatInterval = _lmcBase.serverConfig.heartbeatInterval || _heartbeatInterval;\n\n\t\t\t\t\t//合并im参数,im加载过程中可能会用到资源cdn服务器路径\n\t\t\t\t\t_this.tools.mergeData(imOptions, {\n\t\t\t\t\t\t'resourceCdn' : _lmcBase.serverConfig.resourceCdn.replace('http://', 'https://')\n\t\t\t\t\t});\n\t\t\t\t\t_this.tools.mergeData(imOptions, {\n\t\t\t\t\t\t'clientConfig' : _this.options.modules.im,\n\t\t\t\t\t\t'imConfig' : imConfig,\n\t\t\t\t\t\t'imUserConfig' : _this.options.userConfig,\n\t\t\t\t\t\t'notify' : _notifyProxy\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\timOptions.userContainer = _userContainer;\n\t\t\t\t\t_imOptions = imOptions;\n\t\t\t\t\t\n\t\t\t\t\t_this.debugLog('imOptions');\n\t\t\t\t\t_this.debugLog(imOptions);\n\t\t\t\t\t// 开始心跳轮询\n\t\t\t\t\t_heartbeat();\n\t\t\t\t\t// 开启用户积分轮询\n\t\t\t\t\t_userPointCountPolling();\n\t\t\t\t\t// 初始化用户自己发送的自定义消息列表\n\t\t\t\t\t_this.initCustomMessage();\n\t\t\t\t\t// 初始化用户列表\n\t\t\t\t\t_this.initUserList();\n\t\t\t\t\t\n\t\t\t\t\t// 初始化媒体播放器模块\n\t\t\t\t\t_this.initMediaPlayer(_this.options);\n\t\t\t\t\t//初始化背景音乐播放器\n\t\t\t\t\t_this.initBgmusicPlayer();\n\t\t\t\t\t\n\t\t\t\t\t// 初始化扩展数据列表\n\t\t\t\t\t_this.initExtDataList();\n\n\t\t\t\t}\n\t\t\t},\n\t\t\t'error' : function(err) {\n\t\t\t}\n\t\t});\n\t}\n\t\n\t/**\n\t * 获取用户积分统计\n\t */\n\tthis.getUserPointCount = function(){\n\t\treturn _lmcBase.userPointCount;\n\t}\n\t\n\t\n\t/**\n\t * 检查播放器状态\n\t * \n\t * @param 加载参数\n\t */\n\tthis.checkMediaPlayer = function() {\n\t\ttry {\n\t\t\t_checkMediaPlayerImpl();\n\t\t} catch (e) {\n\t\t\t_this.debugLog('checkMediaPlayer error ');\n\t\t}\n\t}\n\t/**\n\t * 检查背景音乐播放器状态\n\t * \n\t * @param 加载参数\n\t */\n\tthis.checkBgMusicPlayer = function() {\n\t\ttry {\n\t\t\t_checkBgMusicPlayerImpl();\n\t\t} catch (e) {\n\t\t\t_this.debugLog('checkBgMusicPlayer error ');\n\t\t}\n\t}\n\t\n\n\t/**\n\t * 设置选项参数\n\t */\n\tthis.setOption = function(option) {\n\n\t}\n\n\t/**\n\t * 发送自定义消息\n\t */\n\tthis.sendCustomMsg = function(msg) {\n\t\tvar type = msg.type;\n\t\tif ('command' == type) {\n\t\t\t_this.tools.callFunction('onImCustomSend', {\n\t\t\t\t'status' : 'fail',\n\t\t\t\t'error' : '如需发送command消息请使用sendCommand',\n\t\t\t\t'data' : msgData\n\t\t\t});\n\t\t\treturn false;\n\t\t}else if('userStatusPolling' == type || 'initCompleted' == type){\n\t\t\treturn false;\n\t\t}\n        //绑定一个消息id\n        msg.messageId  = _this.tools.uuidInt();\n\t\treturn _sendCustomMsgImpl(msg);\n\t}\n\t\n\t/**\n\t * 发送文本消息\n\t */\n\tthis.sendTextMsg = function(msg,toUserId) {\n\t\tvar self = _userContainer[_this.options.userConfig.userId];\n\t\tif (self.speaking == 'off') {\n\t\t\t_this.tools.callFunction('onCustomMsgRejected', _notify, {\n\t\t\t\t'error' : 'not_allow',\n\t\t\t\t'msg' : msg\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\t\tif(toUserId){\n\t\t\ttoUserId = _this.options.appConfig.appId + toUserId;\n\t\t}\n\t\treturn this.im.sendTextMsg(msg,toUserId, _this.tools.uuidInt());\n\t}\n\t\n\t/**\n\t * 获取emoji数据\n\t */\n\tthis.getEmojis= function() {\n\t\treturn this.im.getEmojis();\n\t}\n\n\t/**\n\t * 发送命令\n\t */\n\tthis.sendCommand = function(msg) {\n\t\tvar type = msg.type;\n\t\tif (!type) {\n\t\t\treturn false;\n\t\t}\n\t\tvar commands = {\n\t\t\t'changeLiveStatus' : {\n\t\t\t\t'action' : 'changeStatus',\n\t\t\t\t'statusFlag' : 'liveStatus'\n\t\t\t},\n\t\t\t'speaking' : {\n\t\t\t\t'action' : 'speaking',\n\t\t\t\t'statusFlag' : 'speaking'\n\t\t\t},\n\t\t\t'barrage' : {\n\t\t\t\t'action' : 'barrage',\n\t\t\t\t'statusFlag' : 'barrage'\n\t\t\t},\n\t\t\t'bgmusic' : {\n\t\t\t\t'action' : 'bgmusic',\n\t\t\t\t'statusFlag' : 'bgmusic'\n\t\t\t},\n            'withdraw' : {\n                'action' : 'withdraw'\n            }\n\t\t};\n\t\tif (!commands.hasOwnProperty(type)) {\n\t\t\t_this.tools.callFunction('onImCustomSend',\n\t\t\t\t\t_notify, {\n\t\t\t\t\t\t'status' : 'fail',\n\t\t\t\t\t\t'error' : '不支持的命令',\n\t\t\t\t\t\t'data' : msg\n\t\t\t\t\t});\n\t\t}\n\t\t\n\t\tmsg.param = msg.param || {};\n\t\tif (!msg.param.toUserId) {\n\t\t\t_cmd[type] = msg.param.status;\n\t\t}\n\t\t// 发送命令之后刷新状态\n\t\tvar command = commands[type];\n\t\tvar commandParam = msg.param;\n\t\tif (type == 'changeLiveStatus') {\n\t\t\t// 获取主播控制的媒体对象\n\t\t\tvar anchorRoomMedia = _getAnchorRoomMedia();\n\t\t\tif(!anchorRoomMedia){\n\t\t\t\t_this.tools.callFunction('onError',_notify, {'error' : '没有可操作的媒体对象'});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tcommandParam.mediaIndex = anchorRoomMedia.mediaIndex;\n\t\t}\n\t\t// 刷新状态\n\t\t_flushStatus([ {\n\t\t\t'name' : command['statusFlag']\n\t\t} ]);\n\t\t_requestLmcData({\n\t\t\t'action' : command.action,\n\t\t\t'data' : commandParam,\n\t\t\t'success' : function(json) {\n\t\t\t\tif (json.error) {\n\t\t\t\t\t_this.tools.callFunction('onImCustomSend',\n\t\t\t\t\t\t\t_notify, {\n\t\t\t\t\t\t\t\t'status' : 'fail',\n\t\t\t\t\t\t\t\t'error' : json.error,\n\t\t\t\t\t\t\t\t'data' : msg\n\t\t\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t_this.im.sendCustomMsg({\n\t\t\t\t\t\t'type' : 'command',\n\t\t\t\t\t\t'data' : {\n\t\t\t\t\t\t\t'command' : type,\n\t\t\t\t\t\t\t'param' : commandParam,\n\t\t\t\t\t\t\t'respose' : json\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\t'error' : function(err) {\n\t\t\t\t_this.tools.callFunction('onImCustomSend',\n\t\t\t\t\t\t_notify, {\n\t\t\t\t\t\t\t'status' : 'fail',\n\t\t\t\t\t\t\t'error' : '命令无法发送到服务器端',\n\t\t\t\t\t\t\t'data' : msg\n\t\t\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t}\n\n\t/**\n\t * 获取播放器状态\n\t */\n\tthis.getPlayerStatus = function(msg) {\n\n\t}\n\t\n\t/**\n\t * 获取用户列表\n\t */\n\tthis.getUserList = function(){\n\t\treturn _userContainer;\n\t}\n\t\n\t/**\n\t * 获取自己发出的自定义消息\n\t */\n\tthis.getselfCustomMessageList = function(){\n\t\treturn _lmcBase.selfCustomMessageList;\n\t}\n\t\n\t/**\n\t * 获取自定义消息计数器\n\t */\n\tthis.getCustomMessageCount = function(){\n\t\treturn _lmcBase.customMessageCount;\n\t}\n\t\n\t/**\n\t * 获取当前鉴权的媒体信息\n\t */\n\tthis.getSignedRoomMedia = function(){\n\t\treturn _signedRoomMedia;\n\t}\t\n\t\n\t/**\n\t * 获取直播间状态\n\t */\n\tthis.getStatus = function(){\n\t\treturn _status;\n\t}\n\t\n\t/**\n\t * 获取基础信息\n\t */\n\tthis.getBase = function(){\n\t\tvar result = {\n\t\t\tendTime : _lmcBase.endTime,\n\t\t\tstartTime : _lmcBase.startTime,\n\t\t\tliveDesc : _lmcBase.liveDesc,\n\t\t\tliveName : _lmcBase.liveName\n\t\t};\n\t\treturn result;\n\t}\n\t\n\t/**\n\t * 设置使用弹幕\n\t */\n\tthis.setUseBarrage = function(useBarrage){\n\t\t_this.options.modules.im.useBarrage = useBarrage;\n\t}\n\n    /**\n     * 加载历史消息\n     */\n    this.loadHistoryTextMessage = function(callback){\n        if(!!_status.historyMsgLoadFinished){\n            return false;\n        }\n        if(!!_status.historyMsgLoadding){\n            return ;\n        }\n    \tvar data = {};\n\n    \tif(_status.historyMsgEarliest){\n            data.lastTime = _status.historyMsgEarliest;\n        }\n        _status.historyMsgLoadding = true;\n        _requestLmcData({\n            'action' : 'getMessage',\n\t\t\t'data' : data,\n            'success' : function(json) {\n                if(!json || json.error || !json.data){\n                \tif(!json.data || json.data.length == 0){\n                \t\t//历史消息加载完成\n                        _status.historyMsgLoadComplete = true;\n                        //历史消息加载结束\n                        _status.historyMsgLoadFinished = true;\n\t\t\t\t\t}\n                    //历史消息加载中的标识\n                    _status.historyMsgLoadding = false;\n                    return false;\n                }\n\n                var len = json.data.length;\n                if(len < 30){\n\t\t\t\t\t//历史消息加载完成\n\t\t\t\t\t_status.historyMsgLoadComplete = true;\n\t\t\t\t\t//历史消息加载结束\n\t\t\t\t\t_status.historyMsgLoadFinished = true;\n                    //历史消息加载中的标识\n                    _status.historyMsgLoadding = false;\n                }\n\n                //重新排序\n\t\t\t\tif(_this.options.modules.im.reverseHistoryMsg){\n                    json.data.reverse();\n\t\t\t\t}\n\n                for ( var i in json.data) {\n                    if(i == len -1){\n                        _status.historyMsgLoadding = false;\n                        if(callback){\n                            try{\n                                callback(json.data);\n                            }catch(e){\n                            }\n                        }\n                    }\n                    var historyMsg = json.data[i];\n                    var userData = _this.tools.parseJson(historyMsg.userData);\n                    if (!userData) {\n                        continue;\n                    }\n\n\t\t\t\t\tif(historyMsg.time && (!_status.historyMsgEarliest || _status.historyMsgEarliest > historyMsg.time)){\n\t\t\t\t\t\t_status.historyMsgEarliest = historyMsg.time;\n\t\t\t\t\t}\n\n                    _this.im.showMessage({\n                        'userId' : _this.options.appConfig.appId +  historyMsg.userId,\n                        'messageId' : historyMsg.messageId,\n                        'nickname' : userData.nickname,\n                        'subGroupId' : historyMsg.subGroupId,\n                        'role' : userData.role,\n                        'headerUrl' : userData.headerUrl,\n                        'content' : historyMsg.content,\n                        'isHistory' : true,\n                        'time' : parseInt(historyMsg.time / 1000),\n                        'sync' : false\n                    });\n                }\n            },\n            'error' : function(err) {\n                _status.historyMsgLoadding = false;\n            }\n        });\n    }\n\t\n\t/**\n\t * 判断是否同组\n\t */\n\tthis.isSameGroup = function(groupId){\n\t\treturn _isSameGroup(groupId);\n\t}\n\t\n\t/**\n\t * 播放声音\n\t */\n\tthis.playAudio = function(_options){\n\t\tvar options = _options || {};\n\t\tvar $audio = _checkAudioPlayerImpl();\n\t\tvar audio = $audio.get(0);\n\t\tif(!audio){\n\t\t\treturn false;\n\t\t}\n\t\tvar loop = !!options.loop;\n\t\taudio.loop = loop;\n\t\tvar url = options.url;\n\t\tif(url){\n\t\t\taudio.src = url;\n\t\t}\n\t\tvar status = options.status || 'play';\n\t\t\n\t\tif(status == 'switch'){\n\t\t\t//音乐开关状态为切换时,在暂停和播放之间进行切换\n\t\t\tif(audio.src && (audio.ended || audio.paused)){\n\t\t\t\tstatus = 'play';\n\t\t\t}else{\n\t\t\t\tstatus = 'paused';\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(window.WeixinJSBridge){\n\t\t\tWeixinJSBridge.invoke('getNetworkType', {}, function(e) {\n\t\t\t\tif (status == 'play' && audio.play) {\n\t\t\t\t\tif (audio.src) {\n\t\t\t\t\t\taudio.play();\n\t\t\t\t\t}\n\t\t\t\t}else if (status == 'paused' && audio.pause) {\n\t\t\t\t\taudio.pause();\n\t\t\t\t}else if (status == 'ended' && audio.duration && audio.fastSeek) {\n\t\t\t\t\taudio.fastSeek(audio.duration);\n\t\t\t\t}else if (status == 'ended') {\n\t\t\t\t\taudio.pause();\n\t\t\t\t}\n\t\t\t});\n\t\t}else{\n\t\t\tif (status == 'play' && audio.play) {\n\t\t\t\tif (audio.src) {\n\t\t\t\t\taudio.play();\n\t\t\t\t}\n\t\t\t}else if (status == 'paused' && audio.pause) {\n\t\t\t\taudio.pause();\n\t\t\t}else if (status == 'ended' && audio.duration && audio.fastSeek) {\n\t\t\t\taudio.fastSeek(audio.duration);\n\t\t\t}else if (status == 'ended') {\n\t\t\t\taudio.pause();\n\t\t\t}\n\t\t}\n\t}\n\n}\n\n/**\n * 注册媒体控制中心对象\n */\nvar LMC = window.LMC || new LmcController();\nexport default LMC\n\n\n// WEBPACK FOOTER //\n// ./src/components/common/lmc.js"],"sourceRoot":""}
webpackJsonp([1],{0:function(e,n){},NHnr:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("IvJb"),o={name:"App",data:()=>({}),components:{},created(){},mounted(){},destroyed(){},methods:{}},r={render:function(){var e=this.$createElement,n=this._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},staticRenderFns:[]};var a=t("vSla")(o,r,!1,function(e){t("g90k")},null,null).exports,s=t("zO6J"),u=t("YmDu"),l={data:()=>({}),computed:{},created(){document.getElementsByTagName("title")[0].innerHTML="视频播放",window.location.href.split("?")[1]&&this.initPlayer(this.getParams())},mounted(){},methods:{getParams(){let e={};return window.location.href.split("?")[1].split("&").map(n=>{e[n.split("=")[0]]=n.split("=")[1]}),e},initPlayer(e){u.a.init({appConfig:{lmcServer:"https://lmc.91haoke.com/core",cacheJs:!0,appId:e.appId,appSign:e.appSign,expire:e.expire,random:e.random,debug:!0,errorPage:null,repeatPage:null,timeoutPage:null,volume:80},liveConfig:{roomId:e.roomId},userConfig:{userId:e.userId,nickname:e.nickname,headerUrl:e.headerUrl,role:e.role,subGroupId:e.subGroupId,onlyGroupMsg:!0},modules:{notify:{onInitCompleted:function(e){console.log(e)}}}})}}},c={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,n=this._self._c||e;return n("div",{attrs:{id:"window"}},[n("div",{attrs:{id:"view"}},[n("div",{staticClass:"col-md-12 col-xs-12 player-box",attrs:{id:"player-box-container"}},[n("div",{staticStyle:{height:"100%"},attrs:{id:"mianPlayerBox"}}),this._v(" "),n("div",{attrs:{id:"auxPlayerBox"}}),this._v(" "),n("div",{attrs:{id:"audioPlayerBox"}})]),this._v(" "),n("div",{staticClass:"view-bottom"})])])}]};var d=t("vSla")(l,c,!1,function(e){t("RYNn")},"data-v-793a2607",null).exports;i.a.use(s.a);var g=new s.a({routes:[{path:"/",name:"Player",component:d}]}),m=(t("D0oh"),t("9rMa"));i.a.use(m.a);var p=new m.a.Store({state:{userToken:"",currentCourseId:"",currentKnowledgeId:"",arrangeList:[],courseName:"",courseStartTime:""},getters:{},mutations:{updateList(e,n){e.arrangeList=n},setUserToken(e,n){e.userToken=n},setcurrentCourseId(e,n){e.currentCourseId=n},setcurrentKnowledgeId(e,n){e.currentKnowledgeId=n},setCourseFinish(e,n){}}}),f=t("OolZ");i.a.use(f.a),i.a.config.productionTip=!1,new i.a({el:"#app",router:g,store:p,components:{App:a},template:"<App/>"})},RYNn:function(e,n){},YmDu:function(module,__webpack_exports__,__webpack_require__){"use strict";(function($,jQuery){function LmcTools(){var console=window.console||{},_version="1_0_3";function init(){console.log=console.log||(console.log=opera.postError),console.log=console.log||window.alert;var e=(new Date).getTime()/1e3;_version=""+(e-e%86400)}init(),this.version=_version,this.callFunction=function(e,n,t){if(!e)return!1;var i=(n=n||window)[e];if(i&&"function"==typeof i){var o=i(t);return void 0===o||"boolean"!=typeof o||o}return!1},this.mergeData=function(e,n){return $.extend(!0,e,n),e},this.loadScript=function(e,n,t){if(!e||!e.length||""==e)return!1;if(e instanceof Array){var i=Math.random(),o=e.length,r="__loadScript__"+i+"__count",a="__loadScript__"+i+"__success";for(var s in window[r]=0,window[a]=!0,e)this.loadScript(e[s],function(e){e||(window[a]=!1),window[r]=window[r]+1,window[r]==o&&n&&(n(window[a]),window[r]=null,window[a]=null)},t)}else if("string"==typeof e){if(window.__loadScript__=window.__loadScript__||{},"loaded"==window.__loadScript__[e])return void(n&&n(!0));window.__loadScript__[e]="loadding";var u=document.createElement("script");u.type="text/javascript",n&&(u.onload=function(){u.readyState&&"loaded"!=u.readyState&&"complete"!=u.readyState||(u.onload=null,window.__loadScript__[e]="loaded",n(!0))},u.onerror=function(){u.onerror=null,window.__loadScript__[e]="error",n(!1)}),u.src=0==t?e+(e.indexOf("?")>-1?"&v=":"?v=")+(new Date).getTime():e+(e.indexOf("?")>-1?"&v=":"?v=")+this.version,document.getElementsByTagName("body")[0].appendChild(u)}},this.debugLog=function(e){console.debug(e)},this.urlParam=function(e,n,t){return(e=e||"").indexOf("?")>-1||(e+="?"),n=n||{},e+=$.param(n)},this.parseJson=function(str){if(!str)return null;var json=null;try{json=$.parseJSON(str)}catch(e){try{json=$.parseJSON("("+str+")")}catch(e){try{json=$.parseJSON("("+str+")")}catch(e){json=eval("("+str+")")}}}return json},this.jsonStringify=function(e){return e?JSON&&JSON.stringify?JSON.stringify(e):void 0:""},this.isMobile=function(){return!!navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)},this.isWeiXin=function(){return!!this.isMobile()&&"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)},this.setCahceVersion=function(e){this.version=e},this.getCahceVersion=function(){return this.version},this.allCharts="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),this.uuid16=function(){for(var e=[16],n=0;n<16;n++)e[n]=this.allCharts[Math.floor(Math.random()*this.allCharts.length)];return e.join("")},this.uuidInt=function(){return Math.round(4294967296*Math.random())}}function LmcIm(e){this.tools=new LmcTools,this.config={loginInfo:{},listeners:{},options:{},baseConfig:{},notify:{},userContainer:{}};var n=this,t=null;this.init=function(e){(t=new WebImBaseControllor).setTools(n.tools);var i=e.imConfig;n.config.baseConfig=e.imConfig||{},n.config.clientConfig=e.clientConfig||{},n.config.notify=e.notify||{},n.config.userContainer=e.userContainer||{};var o=i.sdkAppID,r=e.imUserConfig.headerUrl||e.imConfig.headerUrl;n.config.baseConfig.selType=webim.SESSION_TYPE.GROUP,n.config.baseConfig.selToID=i.avChatRoomId,n.config.baseConfig.selSess=null,n.config.baseConfig.selSessHeadUrl=r;var a={userId:i.userId,appId:i.appId,sdkAppID:o,appIDAt3rd:o,accountType:i.accountType,identifier:i.identifier,identifierNick:e.imUserConfig.nickname||i.identifierNick||"匿名用户",userSig:i.userSign,headerUrl:e.imUserConfig.headerUrl,subGroupId:e.imUserConfig.subGroupId,role:e.imUserConfig.role,onlyGroupMsg:e.imUserConfig.onlyGroupMsg};n.config.loginInfo=a;var s={isAccessFormalEnv:!0,isLogOn:e.debug};n.config.options=s,t.sdkLogin(n.config)},this.sendCustomMsg=function(e){t.sendCustomMsg(e)},this.sendTextMsg=function(e,n,i){t.sendTextMsg(e,n,i)},this.getEmojis=function(){return t.getEmojis()},this.showMessage=function(e){if(!e)return!1;e.fromClient=!0,t.showMessage(e)}}function LmcController(){var e=this,n=null,t=null,i=3e5,o=null,r=null,a=null,s={liveUserCount:0,liveGroupUserCount:0,userStatus:"normal",liveStatus:"wait",serverTime:(new Date).getTime(),serverTimeDiff:0,liveStartTime:0,liveSuspendTime:0,liveEndTime:0,endTime:0,startTime:0,speaking:"on",barrage:"off",bgmusic:"stop",bgmusicUrl:"",orientation:"",currentMediaIndex:null,liveUserIds:""},u=null,l={},c={},d=null,g={},m={},p=function(t){if(!t||!t.userId)return!1;var i=t.userId;t.self=t.userId==e.options.userConfig.userId,t.self&&"off"==t.speaking&&(s.speaking="off");var o=m[i];if(o){var r=!1;o.pointValue!=t.pointValue&&(r=!0,o.pointValue=t.pointValue||o.pointValue),o.subGroupId!=t.subGroupId&&(r=!0,o.subGroupId=t.subGroupId||o.subGroupId),o.lastLoginTime!=t.lastLoginTime&&void 0!=o.lastLoginTime?(r=!0,o.lastLoginTime=t.lastLoginTime||o.lastLoginTime,o.isOnline||(o.isOnline=!0,s.liveUserCount++,t.subGroupId!=e.options.userConfig.subGroupId&&"ALL"!=e.options.userConfig.subGroupId||s.liveGroupUserCount++)):void 0!=o.lastLoginTime&&void 0!=o.isOnline||(r=!0,o.lastLoginTime=t.lastLoginTime||s.serverTime,o.isOnline=!0),o.role!=t.role&&(r=!0,o.role=t.role||o.role),o.nickname!=t.nickname&&(r=!0,o.nickname=t.nickname||o.nickname),o.headerUrl!=t.headerUrl&&(r=!0,o.headerUrl=t.headerUrl||o.headerUrl),o.speaking!=t.speaking&&(r=!0,o.speaking=t.speaking||o.speaking),o.extData!=t.extData&&(r=!0,o.extData=t.extData||o.extData),r&&e.tools.callFunction("onUserChange",n,o)}else-1==s.liveUserIds.indexOf(";"+i+";")&&(s.liveUserIds=s.liveUserIds+";"+i+";",!t.lastLoginTime||t.lastLoginTime>=s.serverTime-32e4?(t.lastLoginTime||(t.lastLoginTime=s.serverTime),t.isOnline=!0,s.liveUserCount++,t.subGroupId!=e.options.userConfig.subGroupId&&"ALL"!=e.options.userConfig.subGroupId||s.liveGroupUserCount++):t.isOnline=!1,t.pointValue=t.pointValue||0,m[i]=t,e.tools.callFunction("onUserJoin",n,t))},f=function(){S({action:"putHeartbeat",data:{headerUrl:e.options.userConfig.headerUrl,extData:e.options.userConfig.extData},success:function(e){s.serverTime=e.serverTime||s.serverTime,C()}})},v=function(){var n=e.tools.mergeData({},m[e.options.userConfig.userId]);e.im.sendCustomMsg({type:"userStatusPolling",data:n})},h=function(){S({action:"getUserPointCount",success:function(e){if(!e||e.error||!e.data)return!1;u.userPointCount=e.data},error:function(e){}})},C=function(){e.tools.callFunction("onPollingTrigger",n,s)},y=function(){s.serverTime+=1e3},I=function(){if(!m)return!1;for(var t in m)if(t){var i=m[t];i&&(!i.lastLoginTime||i.lastLoginTime<s.serverTime-32e4)&&1==i.isOnline&&(i.isOnline=!1,s.liveUserCount--,i.subGroupId!=e.options.userConfig.subGroupId&&"ALL"!=e.options.userConfig.subGroupId||s.liveGroupUserCount--,e.tools.callFunction("onUserChange",n,i))}},S=function(n,t){var i=e.options.appConfig,o=e.options.liveConfig,r=e.options.userConfig,a={appId:i.appId,appSign:i.appSign,expire:i.expire,random:i.random,roomId:o.roomId,userId:r.userId,role:r.role,subGroupId:r.subGroupId,nickname:r.nickname,isFromMobile:e.tools.isMobile(),dataType:"jsonp"},s=n.data||{},u={};e.tools.mergeData(u,s),e.tools.mergeData(u,a),void 0===t&&(t=!0),$.ajax({async:!!t,url:i.lmcServer+"/"+n.action,type:"POST",dataType:"jsonp",jsonp:"jsoncallback",data:u,timeout:5e3,success:function(t){t=t;e.debugLog("lmcData : "),e.debugLog(t),e.tools.callFunction("success",n,t)},error:function(n){e.tools.callFunction("onError",{type:"getLmcConfigError"})}})},T=function(n){if(!n)return!1;if("ALL"==n)return!0;var t=e.options.userConfig.subGroupId,i=n.split(","),o=t.split(","),r=!1;for(var a in i){for(var s in o)if(i[a]==o[s]){r=!0;break}if(r)break}return r},b=function(e,n){if(!n){var t=l[e];if(t)return t}var i=w(e);return i?null==i?{}:(l[e]=i.value,i.value):null},w=function(n){if(!u.cmdDatas||!u.cmdDatas.length)return null;var t=u.cmdDatas,i=null,o=null,r=null,a=null,s=null;if("speaking"==n&&"student"==e.options.userConfig.role){var l=1,c=1,d=1;for(var g in t){if((f=t[g])&&n==f.type){if(s=f,f.receiveSubgroupId&&"ALL"==f.receiveSubgroupId)"ALL"==f.receiveSubgroupId&&(null==o||s.arriveTime>o.arriveTime)&&(o=f,console.log(f),"on"==f.value?d=1:"off"==f.value&&(d=0),console.log(d));else{var m=T(f.receiveSubgroupId),p=f.receiveUserId&&f.receiveUserId==e.options.userConfig.userId;if(!m&&!p)continue;m?(null==r||s.arriveTime>r.arriveTime)&&(r=f,"on"==f.value?c=1:"off"==f.value&&(c=0)):p&&(null==a||s.arriveTime>a.arriveTime)&&(a=f,"on"==f.value?l=1:"off"==f.value&&(l=0))}i||(i=Object.assign({},s)),i.value=l&&c&&d?"on":"off"}}return i}for(var g in t){var f;if((f=t[g])&&n==f.type){if(!f.receiveSubgroupId||"ALL"!=f.receiveSubgroupId){m=T(f.receiveSubgroupId),p=f.receiveUserId&&f.receiveUserId==e.options.userConfig.userId;if(!m&&!p)continue}s=f,i?s.arriveTime>i.arriveTime&&(i=s):i=f}}return i},M=function(e){if(e||(e=[{name:"liveStatus"},{name:"speaking"},{name:"barrage"},{name:"bgmusic"},{name:"liveUserCount"},{name:"liveGroupUserCount"}]),e)for(var n in e){var t=e[n],i=t.name,o=t.skip;"liveStatus"==i?s.liveStatus=b("liveStatus",o)||s.liveStatus:"speaking"==i?s.speaking=b("speaking",o)||s.speaking:"barrage"==i?s.barrage=b("barrage",o)||s.barrage:"bgmusic"==i&&(s.bgmusic=b("bgmusic",o)||s.bgmusic)}},L=function(t){var i=t.data||{},o=t.type,r=u.messageConfigs;if(!r)return!1;var a=r[o];if(!a)return e.tools.callFunction("onCustomMsgRejected",n,{error:"undefined",msg:t}),!1;var s=a.maxValue||0,l=a.intervalValue||0,c=a.users,d=a.roles,g=e.options.userConfig.userId,m=e.options.userConfig.role,p=!0;if(c&&c.length||d&&d.length){if(p=!1,c&&c.length)for(var f in c)if(g==c[f]){p=!0;break}if(!p&&d&&d.length)for(var f in d)if(m==d[f]){p=!0;break}}if(!p)return e.tools.callFunction("onCustomMsgRejected",n,{error:"not_allow",msg:t}),!1;var v=g+"_"+o+"_"+(i.flag||o),h=(new Date).getTime(),C=u.selfCustomMessageList[v];if(C){C.content=i.content;var y=C.count||0,I=C.time;if("initCompleted"!=o){if(s&&y>=s)return e.tools.callFunction("onCustomMsgRejected",n,{error:"too_much",max:s,msg:t}),!1;if(l&&I+1e3*l>=h)return e.tools.callFunction("onCustomMsgRejected",n,{error:"too_fast",lastTime:I,interval:l,time:h,msg:t}),!1}C.previousTime=I,C.count=y+1,C.time=h}else(C={}).time=h,C.previousTime=h,C.content=i.content,C.customType=o,C.count=1,u.selfCustomMessageList[v]=C;e.im.sendCustomMsg(t)},k={onInitCompleted:function(t){return t=t||{},L({type:"initCompleted"}),e.tools.callFunction("onInitCompleted",n,t),!0},onUserDataChange:function(e){return"changeProfile"==(e=e||{}).type&&p(e.data),!0},onPollingTrigger:function(t){return t=t||{},e.tools.callFunction("onPollingTrigger",n,t),!0},onImTextSend:function(t){return"error"==(t=t||{}).status?(e.tools.callFunction("onError",n,{type:"sendTextMsgError",errInfo:t.errInfo}),!1):("on"==s.barrage&&e.options.modules.im.useBarrage&&($("#"+e.options.modules.im.textMsgInput).val(""),e.im.sendCustomMsg({type:"barrage",data:{content:t.content,messageId:t.messageId}})),S({action:"saveMessage",data:{messageType:"text",messageContent:t.content,messageId:t.messageId,userData:e.tools.jsonStringify({nickname:e.options.userConfig.nickname,headerUrl:e.options.userConfig.headerUrl,role:e.options.userConfig.role})}},!0),e.tools.callFunction("onImTextSend",n,t),!0)},onImTextMsgArrive:function(t){return!!t&&(e.tools.callFunction("onImTextMsgArrive",n,t),!0)},onImCustomSend:function(t){var i=(t=t||{}).data||{},r=i.type;if("userLogin"==r)!function(){if(o)return!1;v(),o=setInterval(function(){v()},3e5)}();else if("userStatusPolling"!=r){var a=t.data.data.flag||r;S({action:"saveMessage",data:{messageType:"custom",messageContent:t.data.data.content,flag:a,customType:r}},!1),function(t,i,o){var r=(u.pointConfigs||{})[t+"_"+i];if(r){var a=e.options.userConfig.userId+"_"+t+"_"+(o.flag||t),s=u.selfCustomMessageList[a],l=!0;if(s){var c=s.time||(new Date).getTime(),d=s.count,g=s.previousTime,p=r.maxValue||0,f=r.intervalValue||0,v=s.count;p&&d>p&&(l=!1),f&&v>1&&g+1e3*f>c&&(l=!1)}if(!l)return!1;var h=0,C=r.type,y=!1;if(C&&"simple"!=C){if("complex"==C){var I=o.content,S=r.expressions;if(S&&S.length){var T=null;for(var b in S){var w=S[b],M=w.pattern;M&&("_$ORTHER$_"==M?T=w:M==I&&(h=w.pointValue,y=!0))}!h&&T&&(h=T.pointValue)}}}else h=r.pointValue;if(h&&(h-=0),h){var L=m[e.options.userConfig.userId];L&&(e.tools.callFunction("onGetPoint",n,{pointValue:h,type:t,pointType:C,complexMatch:y}),h+=L.pointValue||0,L.pointValue=h,e.tools.callFunction("onUserChange",n,L))}}}(r,a,i.data)}return e.tools.callFunction("onImCustomSend",n,t),!0},onImCustomArrive:function(t){var i=(t=t||{}).type,o=t.data||{};if("userStatusPolling"==i){var r=o.userData||{};return r.lastLoginTime=s.serverTime||(new Date).getTime(),o.msgData&&(r.pointValue=o.msgData.pointValue),p(r),!1}if("barrage"==i)return e.tools.callFunction("onImCustomArrive",n,t),!1;var a=u.pointConfigs;if(a){var l=a[i+"_"+(o.msgData.flag||i)];if(l&&"multiple"==l.type){var c=(o=t.data||{}).msgData||{},d=e.options.userConfig.userId,g=c.content,f=null;if(g&&(contentJson=e.tools.parseJson(g),contentJson&&(f=contentJson[d])&&!isNaN(f)&&(f-=0)),f){var v=m[e.options.userConfig.userId];if(v)e.tools.callFunction("onGetPoint",n,{pointValue:f,type:i,pointType:l.type}),f+=v.pointValue||0,v.pointValue=f,e.tools.callFunction("onUserChange",n,v)}}}e.tools.callFunction("onImCustomArrive",n,t)},onCommandArrive:function(t){var i=(t=t||{}).type,o=t.data.resposeData||{},r=t.data.resposeParam||{},a=o.data;if((!a.receiveSubgroupId||e.isSameGroup(a.receiveSubgroupId))&&(!a.receiveUserId||a.receiveUserId==e.options.userConfig.userId)){switch(u.cmdDatas.push(a),i){case"changeLiveStatus":var l=r.mediaIndex,c=null;for(var d in u.mediaConfigs){var g=u.mediaConfigs[d];if(g.mediaIndex==l){c=g;break}}if(!c)return!1;var p=r.status;c.liveStatus=p,c.lastOptionTime=o.serverTime,"start"==p?(c.realStartTime=o.serverTime,s.realStartTime=o.serverTime):"suspend"==p?(c.realSuspendTime=o.serverTime,s.realSuspendTime=o.serverTime):"end"==p&&(c.realEndTime=o.serverTime,s.realEndTime=o.serverTime),s.currentMediaIndex=l,s.serverTime=o.serverTime||s.serverTime,s.serverTimeDiff=(new Date).getTime()-o.serverTime,s.liveStatus=c.liveStatus,s.lastOptionTime=c.lastOptionTime||0,s.realStartTime=c.realStartTime||0,s.liveStartTime=c.realStartTime||0,s.realEndTime=c.realEndTime||0,s.currentMediaIndex=l,s.liveStatus=p,s.endTime=c.endTime||0,s.startTime=c.startTime||0,e.tools.callFunction("onLiveStatusChange",n,{status:p}),e.checkMediaPlayer(),C();break;case"speaking":M([{name:"speaking",skip:!0}]);var f=b("speaking");s.speaking=f,m[e.options.userConfig.userId].speaking=s.speaking,C();break;case"barrage":M([{name:"barrage",skip:!0}]);f=b("barrage");s.barrage=f,C();break;case"bgmusic":M([{name:"bgmusic",skip:!0}]);f=b("bgmusic");s.bgmusicUrl=r.cmdData||"",s.bgmusic=f,e.checkBgMusicPlayer(),C();break;case"withdraw":var v=r.messageId;v&&e.tools.callFunction("onWithdrawArrive",n,{messageId:v})}return e.tools.callFunction("onCommandArrive",n,t),!0}},onUserStatusChange:function(t){return"userLoginStatusNotify"==t.type&&"repeat"==t.status?(D("repeat","在其他终端登录,被迫下线"),!1):("userLoginStatusNotify"==t.type&&"login"==t.status?C():"userLoginStatusNotify"==t.type&&"loginSuccess"==t.status&&e.initTextMessageList(),e.tools.callFunction("onUserStatusChange",n,t),!0)},onMediaPlayerStatusChange:function(t){return t=t||{},e.tools.callFunction("onMediaPlayerStatusChange",n,t),!0},onLiveStatusChange:function(t){return t=t||{},e.tools.callFunction("onLiveStatusChange",n,t),!0},onTextMsgSend:function(t){return t=t||{},e.tools.callFunction("onTextMsgSend",n,t),!0},onCustomMsgSend:function(t){return t=t||{},e.tools.callFunction("onCustomMsgSend",n,t),!0},onCommandSend:function(t){if("success"==(t=t||{}).status&&"changeLiveStatus"==t.data.data.command){var i=t.data.data.respose;s.liveStatus=i.liveStatus||i.data.value,s.serverTime=i.serverTime,C(),e.sendCommand({type:"bgmusic",param:{status:"stop"}})}return e.tools.callFunction("onCommandSend",n,t),!0},onNetworkError:function(t){return e.tools.callFunction("onNetworkError",n,t),!0},netNetStatusChange:function(t){return"online"!=t.status&&("reconnect"==t.status?e.initIm(a):"offline"==t.status&&e.tools.callFunction("onNetworkError",n,t)),!0},onPrivateMsgArrive:function(t){return e.tools.callFunction("onPrivateMsgArrive",n,t),!0}},_=function(){var n=e.options.userConfig.userId;if(!s.currentMediaIndex){var t=null;for(var i in u.mediaConfigs){var o=u.mediaConfigs[i];if(o.liveStatus||(o.liveStatus="wait"),o.lastOptionTime||(o.lastOptionTime=0),t){if(o.users)for(var i in o.users)if(o.users[i]==n){t=o;break}o.lastOptionTime||t.lastOptionTime?"end"==t.liveStatus&&"end"!=o.liveStatus?t=o:o.lastOptionTime>t.lastOptionTime&&(t=o):o.isMain&&(t=o)}else t=o}t&&(s.currentMediaIndex=t.mediaIndex,s.endTime=t.endTime,s.startTime=t.startTime,s.liveStatus=t.liveStatus,s.lastOptionTime=t.lastOptionTime||0,s.realStartTime=t.realStartTime||0,s.liveStartTime=t.realStartTime||0,s.realEndTime=t.realEndTime||0)}return function(e){var n=u.room.signedRoomMedias;if(n&&n.length>0)for(var t in n){var i=n[t];if(i.index==e)return i}}(s.currentMediaIndex)},x=function(){if("play"==s.bgmusic){if("wait"==s.liveStatus||"suspend"==s.liveStatus){var n=function(e,n){if(!n){var t=c[e];if(t)return t}var i=w(e);return i?(c[e]=i.cmdData,i.cmdData):{}}("bgmusic",!0);n&&e.playAudio({status:"play",url:n,loop:!0})}}else"stop"==s.bgmusic&&e.playAudio({status:"ended"})},P=function(){var t=e.options.modules.player.audioPlayerBox,i=$("#"+t),o=t+"_inner",r=i.find(".inner");if(0==r.length){var a=$("<div/>");a.attr("class","inner"),a.attr("id",o),i.append(a);var s="<audio></audio>";(r=i.find(".inner")).append(s)}var u=r.find("audio");return!!(s=u.get(0))&&(s.addEventListener("play",function(){e.tools.callFunction("onAudioPlayerStatuChange",n,{url:s.src,status:"play"})},!1),s.addEventListener("pause",function(){e.tools.callFunction("onAudioPlayerStatuChange",n,{url:s.src,status:"pause"})},!1),s.addEventListener("ended",function(){e.tools.callFunction("onAudioPlayerStatuChange",n,{url:s.src,status:"ended"})},!1),u)},U=function(n){var t=n.isLive||!1,i=n.isMobile||!1,o=n.$mainPlayerInner,r=n.mobileVedioType||"->application/x-mpegURL",a=n.innerMainPlayerId,s=n.paltformType,l="/platform/ckplayer6.8/ckplayer/ckplayer.js";t||(l="/platform/ckplayer6.8/ckplayer/ckplayer_playback.js"),e.loadScript(u.serverConfig.resourceCdn+l,function(){window.loadedHandler=function(){o.css({height:"100%",width:"100%"});var e=o.find("video");e&&e.length>0&&(e.css({"z-index":"100"}),e.attr("x-webkit-airplay","true"),e.attr("webkit-playsinline","true"),e.get(0).addEventListener("pause",function(e){this.webkitExitFullscreen&&this.webkitExitFullscreen()}))};var l=n.pcUrls,c=l[0],d="",g=!0;for(var m in l)g?g=!1:d+="|",d+=l[m];var p=null==e.options.appConfig.volume?0:e.options.appConfig.volume,f={a:"",b:"0",c:0,deff:d,f:c,h:"3",p:"1",lv:t?"1":"0",v:p,loaded:"loadedHandler"};if(!t){var v=!1,h=c.split("?");h&&h.length>0&&(v=h[0].lastIndexOf(".m3u8")==h[0].length-5),v&&(f.a=c,f.f=u.serverConfig.resourceCdn+"/platform/ckplayer6.8/plugins/m3u8/m3u8.swf",f.s=4,f.c=0,f.deff=null)}var C=[];if(i){var y=o.find("video");y&&y.length>0&&o.empty(),C.push(n.mobileUrl+r)}CKobject.embed(u.serverConfig.resourceCdn+"/platform/ckplayer6.8/ckplayer/ckplayer.swf",a,s+"ckplayer_mian","100%","100%",!1,f,C,{bgcolor:"#FFF",allowFullScreen:!0,allowScriptAccess:"always",wmode:"transparent"})})},D=function(n,t){var i=e.options.modules.player.mianPlayerBox;$("#"+i).find("video").attr("src","undefined");var o=null;o="repeat"==n?e.options.appConfig.repeatPage:"timeout"==n?e.options.appConfig.timeoutPage:e.options.appConfig.errorPage,$("body").empty(),o?window.location.href=o:alert(t)};this.tools=new LmcTools,this.im=new LmcIm,this.options={appConfig:{lmcServer:"/lmc/core",cacheJs:!1,appId:null,appSign:null,expire:0,random:null,debug:!1,errorPage:null,repeatPage:null,timeoutPage:null,volume:80},liveConfig:{roomId:null},userConfig:{userId:null,nickname:null,headerUrl:null,role:"student",subGroupId:"1",onlyGroupMsg:!0,repeatLogin:!1,onRepeatlogin:null,extData:null},modules:{notify:{onUserJoin:null,onUserOffline:null,onUserChange:null,onInitCompleted:null,onGetPoint:null,onPollingTrigger:null,onImCustomArrive:null,onCommandArrive:null,onPrivateMsgArrive:null,onImTextMsgArrive:null,onWithdrawArrive:null,onUserStatusChange:null,onMediaPlayerStatusChange:null,onLiveStatusChange:null,onImTextMsgSend:null,onCustomMsgSend:null,onCustomMsgRejected:null,onCommandSend:null,onError:null,onNetworkError:null,onOrientationChange:null,onAudioPlayerStatuChange:null},player:{mianPlayerBox:"mianPlayerBox",mianPlayerBoxBackground:null,auxPlayerBox:"auxPlayerBox",audioPlayerBox:"audioPlayerBox",ignoreSuspend:!1,ignoreEnd:!1},im:{onlyGroupMsg:!0,voiceBtn:"voiceBtn",useBarrage:!1,reverseHistoryMsg:!0,emojis:{append:!0,emojiTextTemplate:"[${content}]",maxWidth:"32px",maxHeight:"32px",imgs:{}}}}},this.debugLog=function(e){this.options.appConfig.debug&&this.tools.debugLog(e)},this.loadScript=function(e,n){this.tools.loadScript(e,n,this.options.appConfig.cacheJs)},this.init=function(t){if($||jQuery||alert("请加载jquery库"),e.tools.mergeData(e.options,t),e.debugLog("options"),e.debugLog(e.options),!e.tools.isMobile()){var i=!0;if(void 0!==window.ActiveXObject)try{i=Boolean(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))}catch(e){i=void 0!==navigator.mimeTypes["application/x-shockwave-flash"]}else i=!!navigator.plugins["Shockwave Flash"];if(!i)window.confirm("您的浏览器不支持Flash,请更新后重启浏览器")&&(window.location.href="https://get2.adobe.com/cn/flashplayer/")}e.loadConfig({success:function(t){e.debugLog(t),(u=t).serverConfig?u.serverConfig.resourceCdn&&-1===u.serverConfig.resourceCdn.indexOf("https://")&&(u.serverConfig.resourceCdn=u.serverConfig.resourceCdn.replace("http://","https://")):u.serverConfig={},u.imConfig||(u.imConfig={}),u.messageConfigs||(u.messageConfigs=[]),u.pointConfigs||(u.pointConfigs=[]),u.extDatas||(u.extDatas=[]),u.cmdDatas||(u.cmdDatas=[]),u.usesrCounts||(u.usesrCounts=[]),u.userList||(u.userList=[]),u.selfCustomMessageList||(u.selfCustomMessageList={}),u.customMessageCount||(u.customMessageCount=[]),u.userPointCount||(u.userPointCount=[]),(n=e.options.modules.notify).onImTextMsgArrive||(n.onImTextMsgArrive=e.options.modules.im.chatItemRender),e.initCmdData(),e.tools.isMobile()&&void 0!==window.orientation&&(e.tools.callFunction("onOrientationChange",n,window.orientation%180==0?"vertical":"horizontal"),window.addEventListener("orientationchange",function(){e.tools.callFunction("onOrientationChange",n,window.orientation%180==0?"vertical":"horizontal")}))},error:function(n){e.debugLog("加载脚本错误:"+n)}}),setInterval(C,1e3),setInterval(y,1e3),setInterval(I,6e4)},this.loadConfig=function(n){S({action:"init",data:{nickname:e.options.userConfig.nickname,headerUrl:e.options.userConfig.headerUrl},success:function(t){if(!t||t.error){var i="",o="";return"paramError"==t.code&&("appSign is overdue"==t.message?(i="timeout",o="试听结束"):o="参数错误 "+(t.message||"")),D(i,o),!1}var r=t;e.debugLog("lmcData : "),e.tools.callFunction("success",n,r)},error:function(n){e.tools.callFunction("onError",{type:"getLmcConfigError"})}})},this.initIm=function(n){e.debugLog(n);var t=n.resourceCdn,i=[t+"/platform/tls/sdk/webim.js",t+"/platform/tls/sdk/json2.js",t+"/js/im/tls/base.js"];e.loadScript(i,function(t){if(e.debugLog("初始化im完成:"+t),!t)return alert("加载错误,请刷新重试"+e.tools.jsonStringify(i)),!1;e.im.init(n)})},this.initMediaPlayer=function(n){e.debugLog(n),e.checkMediaPlayer()},this.initBgmusicPlayer=function(n){e.debugLog(n),e.checkBgMusicPlayer()},this.initExtDataList=function(){S({action:"getExtDataList",success:function(t){!t.error&&t.length>0&&e.tools.callFunction("onExtDataListInit",n,t)},error:function(e){}})},this.initUserList=function(){S({action:"getUserList",success:function(n){if(!n.error&&n.data&&n.data.length>0)for(var t in n.data)n.data[t].nickname||(n.data[t].nickname="匿名用户"),p(n.data[t]);e.initIm(a)},error:function(e){}})},this.initCustomMessage=function(){S({action:"getCustomMessage",success:function(e){if(!e||e.error||!e.data)return!1;var n=e.data.selfCustomMessageCount;if(n&&n.length>0)for(var t in n){var i=n[t],o=i.id,r=i.userId+"_"+o.customType+"_"+o.flag;i.id=r,u.selfCustomMessageList[i.id]=i}var a=e.data.customMessageCount;if(a&&a.length>0)for(var t in a)u.customMessageCount.push(a[t])},error:function(e){}})},this.initTextMessageList=function(){e.loadHistoryTextMessage(function(){s.historyMsgLoadComplete=!0})},this.initCmdData=function(){S({action:"getCmdData",success:function(n){if(n&&!n.error){var o={};u.cmdDatas=n,M();var l={userId:e.options.userConfig.userId,appId:e.options.appConfig.appId,identifier:u.room.conf.identifier,userSign:u.room.conf.imSign,sdkAppID:u.room.conf.imsdkAppID,accountType:u.room.conf.imAccountType,avChatRoomId:u.imConfig.imPlatformParam.avChatRoomId},c={userId:e.options.userConfig.userId,nickname:e.options.userConfig.nickname,headerUrl:e.options.userConfig.headerUrl,role:e.options.userConfig.role,subGroupId:e.options.userConfig.subGroupId,pointValue:u.userPointValue||0,lastLoginTime:s.serverTime,extData:e.options.userConfig.extData};p(c),u.serverConfig.resourceCdn=u.serverConfig.resourceCdn||"",i=u.serverConfig.heartbeatInterval||i,e.tools.mergeData(o,{resourceCdn:u.serverConfig.resourceCdn.replace("http://","https://")}),e.tools.mergeData(o,{clientConfig:e.options.modules.im,imConfig:l,imUserConfig:e.options.userConfig,notify:k}),o.userContainer=m,a=o,e.debugLog("imOptions"),e.debugLog(o),function(){if(t)return!1;f(),t=setInterval(function(){f()},i)}(),function(){if(r)return!1;h(),r=setInterval(function(){h()},3e5)}(),e.initCustomMessage(),e.initUserList(),e.initMediaPlayer(e.options),e.initBgmusicPlayer(),e.initExtDataList()}},error:function(e){}})},this.getUserPointCount=function(){return u.userPointCount},this.checkMediaPlayer=function(){try{!function(){var n=e.options.modules.player.mianPlayerBox,t=e.options.modules.player.auxPlayerBox,i=e.options.modules.player.ignoreSuspend;e.options.modules.player.ignoreEnd;if(!n)return e.debugLog("options.modules.player.mianPlayerBox is not defined "),!1;var o=_();d=o;var r=o.paltformType,a=e.tools.isMobile(),l=$("#"+n),c=$("#"+t),m=n+"_inner",p=n+"_inner",f=l.find(".inner");0==f.length&&((v=$("<div/>")).attr("class","inner"),v.attr("id",m),v.css({height:"100%",width:"100%",cursor:"pointer"}),l.append(v),f=l.find(".inner"));var v,h=c.find(".inner");0==h.length&&((v=$("<div/>")).attr("class","inner"),v.attr("id",p),c.append(v),h=c.find(".inner"));var C=e.options.modules.player.mianPlayerBoxBackground,y=u.serverConfig.resourceCdn+"/images/placeholder/player_bg_"+s.liveStatus+".png";if(C&&C[s.liveStatus]&&(y=C[s.liveStatus]),l.css({background:'url("'+y+'") no-repeat scroll 0 0 / 100% 100%'}),"end"==s.liveStatus){var I=null,S=u.room.signedRoomPlaybackMedias;S&&S.length&&(I=S[0]);var T=null;if(null!=I){if(l.show(),f.show(),"aliyun"==(T=I.playbakcPlatformType)){var b={isLive:!1,isMobile:a,$mainPlayerInner:f,mobileVedioType:"->application/octet-stream",innerMainPlayerId:m,paltformType:T},w=I.playList,M="",L=[];for(var k in w.sort(function(e,n){return n.bitrate-e.bitrate}),w){var x=w[k];"mp4"==x.format?(L.push(x.url),M=x.url):"m3u8"==x.format&&(L.push(x.url),M=x.url)}b.mobileUrl=M,b.pcUrls=L,U(b)}}else"aliyun"==r?a?(f.hide(),(E=f.find("video"))&&E.length>0&&(E.get(0).pause(),E.attr("src","undefined"))):f.remove():"huantuo"==r&&(f.hide(),(A=g[r+"SDK_MAIN"])||A.stop())}else if("start"==s.liveStatus||"wait"==s.liveStatus&&i||"suspend"==s.liveStatus&&i){if(l.show(),f.show(),"aliyun"==r){b={isLive:!0,isMobile:a,$mainPlayerInner:f,mobileVedioType:"->application/x-mpegURL",innerMainPlayerId:m,paltformType:r},M="",L=[];var D=o.FLV_URL;L.push(D),L.push(o.HD_RTMP_URL),L.push(o.SD_RTMP_URL),b.mobileUrl=o.M3U8_URL,b.pcUrls=L,U(b)}else if("huantuo"==r){var F="";F=a?"/maituo_v2/dist/sdk-mobile.min.js":"/maituo_v2/dist/sdk-pc.min.js",e.loadScript(["http://static-1.talk-fun.com/open"+F],function(){var n=r+"_auxPlayer",t=r+"_mainPlayer";$("#"+innerAudioPlayerId).show(),$("#"+p).show();var i=g[r+"SDK_MAIN"],a=o.data.access_token;i||(i=new MT.SDK.main(a),g[r+"SDK_MAIN"]=i,i.camera(p,n,function(n){e.debugLog("辅助播放器加载完成！"),$(n).hide()}),i.mainPlayer(m,t,function(n){e.debugLog("主播放器加载完成！")}))})}}else if("wait"==s.liveStatus);else if("suspend"==s.liveStatus){var E;if("aliyun"==r)a?(f.hide(),(E=f.find("video"))&&E.length>0&&(E.get(0).pause(),E.attr("src","undefined"))):f.remove();else if("huantuo"==r){var A;f.hide(),(A=g[r+"SDK_MAIN"])||A.stop()}}P()}()}catch(n){e.debugLog("checkMediaPlayer error ")}},this.checkBgMusicPlayer=function(){try{x()}catch(n){e.debugLog("checkBgMusicPlayer error ")}},this.setOption=function(e){},this.sendCustomMsg=function(n){var t=n.type;return"command"==t?(e.tools.callFunction("onImCustomSend",{status:"fail",error:"如需发送command消息请使用sendCommand",data:msgData}),!1):"userStatusPolling"!=t&&"initCompleted"!=t&&(n.messageId=e.tools.uuidInt(),L(n))},this.sendTextMsg=function(t,i){return"off"==m[e.options.userConfig.userId].speaking?(e.tools.callFunction("onCustomMsgRejected",n,{error:"not_allow",msg:t}),!1):(i&&(i=e.options.appConfig.appId+i),this.im.sendTextMsg(t,i,e.tools.uuidInt()))},this.getEmojis=function(){return this.im.getEmojis()},this.sendCommand=function(t){var i=t.type;if(!i)return!1;var o={changeLiveStatus:{action:"changeStatus",statusFlag:"liveStatus"},speaking:{action:"speaking",statusFlag:"speaking"},barrage:{action:"barrage",statusFlag:"barrage"},bgmusic:{action:"bgmusic",statusFlag:"bgmusic"},withdraw:{action:"withdraw"}};o.hasOwnProperty(i)||e.tools.callFunction("onImCustomSend",n,{status:"fail",error:"不支持的命令",data:t}),t.param=t.param||{},t.param.toUserId||(l[i]=t.param.status);var r=o[i],a=t.param;if("changeLiveStatus"==i){var s=function(){var n=u.mediaConfigs;if(n&&n.length>0)for(var t in n){var i=n[t],o=i.users;if(o)for(var t in o)if(o[t]==e.options.userConfig.userId)return i}return null}();if(!s)return e.tools.callFunction("onError",n,{error:"没有可操作的媒体对象"}),!1;a.mediaIndex=s.mediaIndex}M([{name:r.statusFlag}]),S({action:r.action,data:a,success:function(o){o.error?e.tools.callFunction("onImCustomSend",n,{status:"fail",error:o.error,data:t}):e.im.sendCustomMsg({type:"command",data:{command:i,param:a,respose:o}})},error:function(i){e.tools.callFunction("onImCustomSend",n,{status:"fail",error:"命令无法发送到服务器端",data:t})}})},this.getPlayerStatus=function(e){},this.getUserList=function(){return m},this.getselfCustomMessageList=function(){return u.selfCustomMessageList},this.getCustomMessageCount=function(){return u.customMessageCount},this.getSignedRoomMedia=function(){return d},this.getStatus=function(){return s},this.getBase=function(){return{endTime:u.endTime,startTime:u.startTime,liveDesc:u.liveDesc,liveName:u.liveName}},this.setUseBarrage=function(n){e.options.modules.im.useBarrage=n},this.loadHistoryTextMessage=function(n){if(s.historyMsgLoadFinished)return!1;if(!s.historyMsgLoadding){var t={};s.historyMsgEarliest&&(t.lastTime=s.historyMsgEarliest),s.historyMsgLoadding=!0,S({action:"getMessage",data:t,success:function(t){if(!t||t.error||!t.data)return t.data&&0!=t.data.length||(s.historyMsgLoadComplete=!0,s.historyMsgLoadFinished=!0),s.historyMsgLoadding=!1,!1;var i=t.data.length;for(var o in i<30&&(s.historyMsgLoadComplete=!0,s.historyMsgLoadFinished=!0,s.historyMsgLoadding=!1),e.options.modules.im.reverseHistoryMsg&&t.data.reverse(),t.data){if(o==i-1&&(s.historyMsgLoadding=!1,n))try{n(t.data)}catch(e){}var r=t.data[o],a=e.tools.parseJson(r.userData);a&&(r.time&&(!s.historyMsgEarliest||s.historyMsgEarliest>r.time)&&(s.historyMsgEarliest=r.time),e.im.showMessage({userId:e.options.appConfig.appId+r.userId,messageId:r.messageId,nickname:a.nickname,subGroupId:r.subGroupId,role:a.role,headerUrl:a.headerUrl,content:r.content,isHistory:!0,time:parseInt(r.time/1e3),sync:!1}))}},error:function(e){s.historyMsgLoadding=!1}})}},this.isSameGroup=function(e){return T(e)},this.playAudio=function(e){var n=e||{},t=P().get(0);if(!t)return!1;var i=!!n.loop;t.loop=i;var o=n.url;o&&(t.src=o);var r=n.status||"play";"switch"==r&&(r=t.src&&(t.ended||t.paused)?"play":"paused"),window.WeixinJSBridge?WeixinJSBridge.invoke("getNetworkType",{},function(e){"play"==r&&t.play?t.src&&t.play():"paused"==r&&t.pause?t.pause():"ended"==r&&t.duration&&t.fastSeek?t.fastSeek(t.duration):"ended"==r&&t.pause()}):"play"==r&&t.play?t.src&&t.play():"paused"==r&&t.pause?t.pause():"ended"==r&&t.duration&&t.fastSeek?t.fastSeek(t.duration):"ended"==r&&t.pause()}}var LMC=window.LMC||new LmcController;__webpack_exports__.a=LMC}).call(__webpack_exports__,__webpack_require__("L7Pj"),__webpack_require__("L7Pj"))},g90k:function(e,n){}},["NHnr"]);
//# sourceMappingURL=app.c3a6c9bfc68fde574868.js.map